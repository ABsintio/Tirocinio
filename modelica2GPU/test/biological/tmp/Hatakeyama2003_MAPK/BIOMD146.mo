
model BIOMD146 "Hatakeyama2003_MAPK"

    function pow
        input  Real x;
        input  Real power;
        output Real y;
        algorithm
            y := x^power;
    end pow;

    parameter Real k1 = 0.0012;
    parameter Real k2 = 0.01;
    parameter Real k3 = 1.0;
    parameter Real k5 = 0.1;
    parameter Real k6 = 20.0;
    parameter Real k7 = 60.0;
    parameter Real k8 = 2040.0;
    parameter Real k9 = 40.8;
    parameter Real V10 = 0.0154;
    parameter Real k11 = 0.222;
    parameter Real V12 = 0.289;
    parameter Real k13 = 1.53;
    parameter Real k14 = 0.00673;
    parameter Real k15 = 3.5;
    parameter Real k16 = 0.058;
    parameter Real k17 = 2.9;
    parameter Real k20 = 0.3;
    parameter Real k18 = 0.058;
    parameter Real k19 = 9.5;
    parameter Real k21 = 16.0;
    parameter Real k22 = 0.27;
    parameter Real k23 = 0.1;
    parameter Real k24 = 9.85;
    parameter Real k25 = 45.8;
    parameter Real k27 = 16.9;
    parameter Real V26 = 2620.0;
    parameter Real V28 = 17000.0;
    parameter Real k29 = 507.0;
    parameter Real V30 = 20000.0;
    parameter Real k31 = 0.107;
    parameter Real V32 = 20000.0;
    parameter Real k33 = 0.211;
    parameter Real k34 = 0.001;
    parameter Real k_1 = 0.00076;
    parameter Real k_2 = 0.1;
    parameter Real k_3 = 0.01;
    parameter Real K4 = 50.0;
    parameter Real k_5 = 1.0;
    parameter Real k_6 = 5.0;
    parameter Real k_7 = 546.0;
    parameter Real k_8 = 15700.0;
    parameter Real k_9 = 0.0;
    parameter Real K10 = 340.0;
    parameter Real K11 = 0.181;
    parameter Real K12 = 0.0571;
    parameter Real K13 = 11.7;
    parameter Real K14 = 8.07;
    parameter Real K15 = 317.0;
    parameter Real K18 = 60.0;
    parameter Real K19 = 146000.0;
    parameter Real K20 = 160.0;
    parameter Real K21 = 146000.0;
    parameter Real K22 = 60.0;
    parameter Real k_23 = 2.0;
    parameter Real k_24 = 0.0985;
    parameter Real k_25 = 0.047;
    parameter Real K26 = 3680.0;
    parameter Real K27 = 39.1;
    parameter Real K28 = 9.02;
    parameter Real K30 = 80000.0;
    parameter Real K31 = 4.35;
    parameter Real K32 = 80000.0;
    parameter Real K33 = 12.0;
    parameter Real k_34 = 0.0;
    parameter Real V4 = 62.5;
    parameter Real K17 = 317.0;
    parameter Real K16 = 2200.0;
    parameter Real k_29 = 234.0;

    Real RP_percent(start=0.0);
    Real AktPP_percent(start=0.0);
    Real MEKPP_percent(start=0.0);
    Real ERKPP_percent(start=0.0);
    Real Rafstar_percent(start=0.0);
    Real ShP_percent(start=0.0);
    Real PI3Kstar_percent(start=0.0);

    Real Akt;
    Real AktPIP3;
    Real AktPIP;
    Real AktPIPP;
    Real ERK;
    Real ERKP;
    Real ERKPP;
    Real GS;
    Real HRG;
    Real MEK;
    Real MEKP;
    Real MEKPP;
    Real PI3K;
    Real PI3Kstar;
    Real PIP3;
    Real R;
    Real RP;
    Real RHRG;
    Real RHRG2;
    Real RPI3K;
    Real RPI3Kstar;
    Real RShGS;
    Real RShP;
    Real RShc;
    Real Raf;
    Real Rafstar;
    Real RasGDP;
    Real RasGTP;
    Real ShGS;
    Real ShP;
    Real Shc;
    Real P_I;
    Real internalization;
    Real E;
    Real MKP3;
    Real PP2A;

initial equation
    Akt = 10.0;
    AktPIP3 = 0.0;
    AktPIP = 0.0;
    AktPIPP = 0.0;
    ERK = 1000.0;
    ERKP = 0.0;
    ERKPP = 0.0;
    GS = 10.0;
    HRG = 330.0;
    MEK = 120.0;
    MEKP = 0.0;
    MEKPP = 0.0;
    PI3K = 10.0;
    PI3Kstar = 0.0;
    PIP3 = 0.0;
    R = 80.0;
    RP = 0.0;
    RHRG = 0.0;
    RHRG2 = 0.0;
    RPI3K = 0.0;
    RPI3Kstar = 0.0;
    RShGS = 0.0;
    RShP = 0.0;
    RShc = 0.0;
    Raf = 100.0;
    Rafstar = 0.0;
    RasGDP = 120.0;
    RasGTP = 0.0;
    ShGS = 0.0;
    ShP = 0.0;
    Shc = 1000.0;
    P_I = 800.0;
    internalization = 0.0;
    E = 7.0;
    MKP3 = 2.4;
    PP2A = 11.4;

equation
    RP_percent = (RP + RPI3K + RPI3Kstar + RShGS + RShP + RShc) * 200 / 80;
    ERKPP_percent = ERKPP * 100 / 1000;
    AktPP_percent = AktPIPP * 100 / 10;
    MEKPP_percent = MEKPP * 100 / 120;
    ShP_percent = ShP * 100 / 1000;
    PI3Kstar_percent = PI3Kstar * 100 / 10;
    Rafstar_percent = Rafstar * 100 / 100;
    der(Akt) =  - (1.0 * (k29 * PIP3 * Akt - k_29 * AktPIP3));
    der(AktPIP3) = (1.0 * (k29 * PIP3 * Akt - k_29 * AktPIP3)) + (1.0 * k31 * PP2A * AktPIP / (K31 * (1 + MEKP / K16 + MEKPP / K18 + AktPIPP / K33) + AktPIP)) - (1.0 * V30 * AktPIP3 / (K30 * (1 + AktPIP / K32) + AktPIP3));
    der(AktPIP) = (1.0 * V30 * AktPIP3 / (K30 * (1 + AktPIP / K32) + AktPIP3)) + (1.0 * k33 * PP2A * AktPIPP / (K33 * (1 + MEKP / K16 + MEKPP / K18 + AktPIP / K31) + AktPIPP)) - (1.0 * k31 * PP2A * AktPIP / (K31 * (1 + MEKP / K16 + MEKPP / K18 + AktPIPP / K33) + AktPIP)) - (1.0 * V32 * AktPIP / (K32 * (1 + AktPIP3 / K30) + AktPIP));
    der(AktPIPP) = (1.0 * V32 * AktPIP / (K32 * (1 + AktPIP3 / K30) + AktPIP)) - (1.0 * k33 * PP2A * AktPIPP / (K33 * (1 + MEKP / K16 + MEKPP / K18 + AktPIP / K31) + AktPIPP));
    der(ERK) = (1.0 * k20 * MKP3 * ERKP / (K20 * (1 + ERKPP / K22) + ERKP)) - (1.0 * k19 * MEKPP * ERK / (K19 * (1 + ERKP / K21) + ERK));
    der(ERKP) = (1.0 * k19 * MEKPP * ERK / (K19 * (1 + ERKP / K21) + ERK)) + (1.0 * k22 * MKP3 * ERKPP / (K22 * (1 + ERKP / K20) + ERKPP)) - (1.0 * k20 * MKP3 * ERKP / (K20 * (1 + ERKPP / K22) + ERKP)) - (1.0 * k21 * MEKPP * ERKP / (K21 * (1 + ERK / K19) + ERKP));
    der(ERKPP) = (1.0 * k21 * MEKPP * ERKP / (K21 * (1 + ERK / K19) + ERKP)) - (1.0 * k22 * MKP3 * ERKPP / (K22 * (1 + ERKP / K20) + ERKPP));
    der(GS) = (1.0 * (k9 * ShGS - k_9 * GS * ShP)) - (1.0 * (k7 * RShP * GS - k_7 * RShGS));
    der(HRG) =  - (1.0 * (k1 * R * HRG - k_1 * RHRG));
    der(MEK) = (1.0 * k16 * PP2A * MEKP / (K16 * (1 + MEKPP / K18 + AktPIP / K31 + AktPIPP / K33) + MEKP)) - (1.0 * k15 * Rafstar * MEK / (K15 * (1 + MEKP / K17) + MEK));
    der(MEKP) = (1.0 * k15 * Rafstar * MEK / (K15 * (1 + MEKP / K17) + MEK)) + (1.0 * k18 * PP2A * MEKPP / (K18 * (1 + MEKP / K16 + AktPIPP / K31 + AktPIPP / K33) + MEKPP)) - (1.0 * k16 * PP2A * MEKP / (K16 * (1 + MEKPP / K18 + AktPIP / K31 + AktPIPP / K33) + MEKP)) - (1.0 * k17 * Rafstar * MEKP / (K17 * (1 + MEK / K15) + MEKP));
    der(MEKPP) = (1.0 * k17 * Rafstar * MEKP / (K17 * (1 + MEK / K15) + MEKP)) - (1.0 * k18 * PP2A * MEKPP / (K18 * (1 + MEKP / K16 + AktPIPP / K31 + AktPIPP / K33) + MEKPP));
    der(PI3K) = (1.0 * V26 * PI3Kstar / (K26 + PI3Kstar)) - (1.0 * (k23 * RP * PI3K - k_23 * RPI3K));
    der(PI3Kstar) = (1.0 * (k25 * RPI3Kstar - k_25 * RP * PI3Kstar)) - (1.0 * V26 * PI3Kstar / (K26 + PI3Kstar));
    der(PIP3) = (1.0 * k27 * PI3Kstar * P_I / (K27 + P_I)) - (1.0 * (k29 * PIP3 * Akt - k_29 * AktPIP3)) - (1.0 * (V28 * PIP3 / (K28 + PIP3)));
    der(R) =  - (1.0 * (k1 * R * HRG - k_1 * RHRG));
    der(RP) = (1.0 * (k3 * RHRG2 - k_3 * RP)) + (1.0 * (k8 * RShGS - k_8 * ShGS * RP)) + (1.0 * (k25 * RPI3Kstar - k_25 * RP * PI3Kstar)) - (1.0 * V4 * RP / (K4 + RP)) - (1.0 * (k5 * RP * Shc - k_5 * RShc)) - (1.0 * (k23 * RP * PI3K - k_23 * RPI3K)) - (1.0 * (k34 * RP - k_34 * internalization));
    der(RHRG) = (1.0 * (k1 * R * HRG - k_1 * RHRG)) - (2.0 * 1.0 * (k2 * RHRG^2 - k_2 * RHRG2));
    der(RHRG2) = (1.0 * (k2 * RHRG^2 - k_2 * RHRG2)) + (1.0 * V4 * RP / (K4 + RP)) - (1.0 * (k3 * RHRG2 - k_3 * RP));
    der(RPI3K) = (1.0 * (k23 * RP * PI3K - k_23 * RPI3K)) - (1.0 * (k24 * RPI3K - k_24 * RPI3Kstar));
    der(RPI3Kstar) = (1.0 * (k24 * RPI3K - k_24 * RPI3Kstar)) - (1.0 * (k25 * RPI3Kstar - k_25 * RP * PI3Kstar));
    der(RShGS) = (1.0 * (k7 * RShP * GS - k_7 * RShGS)) - (1.0 * (k8 * RShGS - k_8 * ShGS * RP));
    der(RShP) = (1.0 * (k6 * RShc - k_6 * RShP)) - (1.0 * (k7 * RShP * GS - k_7 * RShGS));
    der(RShc) = (1.0 * (k5 * RP * Shc - k_5 * RShc)) - (1.0 * (k6 * RShc - k_6 * RShP));
    der(Raf) = (1.0 * k14 * (AktPIPP + E) * Rafstar / (K14 + Rafstar)) - (1.0 * (k13 * RasGTP * Raf / (K13 + Raf)));
    der(Rafstar) = (1.0 * (k13 * RasGTP * Raf / (K13 + Raf))) - (1.0 * k14 * (AktPIPP + E) * Rafstar / (K14 + Rafstar));
    der(RasGDP) = (1.0 * (V12 * RasGTP / (K12 + RasGTP))) - (1.0 * (k11 * ShGS * RasGDP / (K11 + RasGDP)));
    der(RasGTP) = (1.0 * (k11 * ShGS * RasGDP / (K11 + RasGDP))) - (1.0 * (V12 * RasGTP / (K12 + RasGTP)));
    der(ShGS) = (1.0 * (k8 * RShGS - k_8 * ShGS * RP)) - (1.0 * (k9 * ShGS - k_9 * GS * ShP));
    der(ShP) = (1.0 * (k9 * ShGS - k_9 * GS * ShP)) - (1.0 * V10 * ShP / (K10 + ShP));
    der(Shc) = (1.0 * V10 * ShP / (K10 + ShP)) - (1.0 * (k5 * RP * Shc - k_5 * RShc));
    der(P_I) = (1.0 * (V28 * PIP3 / (K28 + PIP3))) - (1.0 * k27 * PI3Kstar * P_I / (K27 + P_I));
    der(internalization) = (1.0 * (k34 * RP - k_34 * internalization)) ;
    der(E) = 0.0;
    der(MKP3) = 0.0;
    der(PP2A) = 0.0;




end BIOMD146;
