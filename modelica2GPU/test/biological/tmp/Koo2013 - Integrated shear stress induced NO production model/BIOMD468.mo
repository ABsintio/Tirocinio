
model BIOMD468 "Koo2013 - Integrated shear stress induced NO production model"

    function pow
        input  Real x;
        input  Real power;
        output Real y;
        algorithm
            y := x^power;
    end pow;
    
    function piecewise
        input Real x;
        input Boolean condition;
        input Real y;
        output Real z;
        algorithm
            z := if condition then x else y;
    end piecewise;



    parameter Real R_T = 44000.0;
    parameter Real k1 = 0.0012;
    parameter Real k2 = 2.0;
    parameter Real k3 = 6.64;
    parameter Real k4 = 5000.0;
    parameter Real k5 = 1e-10;
    parameter Real k6 = 0.1;
    parameter Real k7 = 300.0;
    parameter Real K1 = 0.0;
    parameter Real K2 = 200.0;
    parameter Real K3 = 150.0;
    parameter Real K4 = 80.0;
    parameter Real K5 = 321.0;
    parameter Real K_hi = 380.0;
    parameter Real k_CICR = 1.0;
    parameter Real K_CICR = 0.0;
    parameter Real k_CCE = 0.0;
    parameter Real B_T = 120000.0;
    parameter Real Vc_Vs = 3.5;
    parameter Real dot_Vp = 1630.0;
    parameter Real dot_Vex = 18330.0;
    parameter Real dot_Vhi = 4760.0;
    parameter Real dot_q_inpass = 6000.0;
    parameter Real dot_q_instim = 2500.0;
    parameter Real Cao = 100.0;
    parameter Real tau_I = 33.0;
    parameter Real tau_II = 0.005;
    parameter Real half = 0.5;
    parameter Real fracK = 7071067.81;
    parameter Real alp = 10.0;
    parameter Real gam = 0.1;
    parameter Real k8 = 7.5e-05;
    parameter Real k11 = 0.004;
    parameter Real k12 = 10.3;
    parameter Real k13 = 0.08;
    parameter Real k14 = 1152.0;
    parameter Real k15 = 0.015;
    parameter Real k16 = 0.0;
    parameter Real k17 = 0.00015;
    parameter Real k18 = 1.5;
    parameter Real kp = 0.1;
    parameter Real Kmp = 5.0;
    parameter Real Kmdp = 20.0;
    parameter Real Vdp = 4.0;
    parameter Real k90 = 0.002;
    parameter Real kr90 = 1.5;
    parameter Real kDD = 9.45e-05;
    parameter Real unisec_8 = 1.0;
    parameter Real normal_21 = 0.907;
    parameter Real unity_21 = 1.0;
    parameter Real unimol_21 = 1.0;
    parameter Real tf_21 = 15.0;
    parameter Real k58_22 = 0.2;
    parameter Real Km58_22 = 6170.0;
    parameter Real k59_23 = 7.5;
    parameter Real Km59_23 = 80.9;
    parameter Real k60_24 = 0.045;
    parameter Real kr60_24 = 0.089;
    parameter Real k61_25 = 20.0;
    parameter Real Km61_25 = 80000.0;
    parameter Real k62_26 = 20.0;
    parameter Real Km62_26 = 80000.0;
    parameter Real k63_27 = 0.037;
    parameter Real Km63_27 = 8800.0;
    parameter Real k64_28 = 0.04;
    parameter Real Km64_28 = 48000.0;
    parameter Real k65_29 = 0.163;
    parameter Real Km65_29 = 48000.0;
    parameter Real k66_30 = 0.0007;
    parameter Real k67_31 = 0.98;
    parameter Real unitime_32 = 1.0;
    parameter Real K_cam_no_33 = 17.0;
    parameter Real K_p_no_33 = 5.0;
    parameter Real K_pcam_no_33 = 17.0;
    parameter Real normal_37 = 4.0;
    parameter Real tf_37 = 60.0;
    parameter Real unity_37 = 1.0;
    parameter Real unimol_37 = 1.0;
    parameter Real tiny_num_37 = 1e-06;
    parameter Real normal_38 = 0.026;
    parameter Real tf_38 = 540.0;
    parameter Real unity_38 = 1.0;
    parameter Real unimol_38 = 1.0;
    parameter Real k105_39 = 0.1;
    parameter Real k_105_39 = 1.0;
    parameter Real kcat_src_40 = 8.33;
    parameter Real k_6_40 = 5.0;
    parameter Real k107_41 = 60.0;
    parameter Real k_107_41 = 546.0;
    parameter Real k108_42 = 2040.0;
    parameter Real k_108_42 = 15700.0;
    parameter Real V10_43 = 154.0;
    parameter Real K10_43 = 340.0;
    parameter Real k9_44 = 40.8;
    parameter Real kT_45 = 0.001;
    parameter Real ktr1_46 = 0.00012;
    parameter Real ktr1k2_46 = 9e-06;
    parameter Real tr2_46 = 3e-06;
    parameter Real k111_47 = 0.222;
    parameter Real K111_47 = 0.181;
    parameter Real V12_48 = 0.289;
    parameter Real K12_48 = 0.0571;
    parameter Real k113_49 = 0.035;
    parameter Real K113_49 = 10.0;
    parameter Real K18_50 = 8.0;
    parameter Real V18_50 = 0.125;
    parameter Real k19_51 = 0.005;
    parameter Real K19_51 = 15.0;
    parameter Real K20_52 = 15.0;
    parameter Real V20_52 = 0.375;
    parameter Real k21_53 = 0.002;
    parameter Real K21_53 = 30.0;
    parameter Real K22_54 = 15.0;
    parameter Real V22_54 = 0.05;
    parameter Real kD_55 = 2.8e-05;
    parameter Real kP_56 = 0.02824;
    parameter Real K30_56 = 16.0;
    parameter Real unitime_57 = 1.0;
    parameter Real V37_58 = 0.375;
    parameter Real K37_58 = 15.0;
    parameter Real k38_59 = 0.005;
    parameter Real K38_59 = 15.0;
    parameter Real V39_60 = 0.05;
    parameter Real K39_60 = 15.0;
    parameter Real k40_61 = 0.002;
    parameter Real K40_61 = 30.0;
    parameter Real K43_62 = 25.0;
    parameter Real k43_62 = 4e-05;
    parameter Real K44_63 = 5.0;
    parameter Real V44_63 = 0.002;
    parameter Real tau_64 = 0.55;
    parameter Real tc_64 = 3600.0;
    parameter Real uc_64 = 3600.0;
    parameter Real delay_64 = 5.0;
    parameter Real unity_64 = 20.0;
    parameter Real default = 1.0;
    parameter Real c1 = 1.0;
    parameter Real c2 = 1.0;
    parameter Real c3 = 1.0;



    Real s1;
    Real s2;
    Real s3;
    Real s4;
    Real s5;
    Real s6;
    Real s7;
    Real s8;
    Real s9;
    Real s10;
    Real s11;
    Real s12;
    Real s13;
    Real s14;
    Real s15;
    Real s16;
    Real s17;
    Real s18;
    Real s19;
    Real s20;
    Real s21;
    Real s22;
    Real s23;
    Real s24;
    Real s25;
    Real s26;
    Real s27;
    Real s28;
    Real s35;
    Real s37;
    Real s38;
    Real s39;
    Real s42;
    Real s43;
    Real s44;
    Real s45;
    Real s47;
    Real s48;
    Real s49;
    Real s50;
    Real s51;
    Real s52;
    Real s57;
    Real s58;
    Real s60;
    Real s61;
    Real s62;
    Real s63;
    Real s64;
    Real s65;
    Real s66;
    Real s91;
    Real s92;
    Real s93;
    Real s94;
    Real s95;
    Real s96;
    Real s97;
    Real s98;
    Real s99;
    Real s100;
    Real s101;
    Real s102;
    Real s103;
    Real s104;
    Real s105;
    Real s106;
    Real s107;
    Real s108;
    Real s110;
    Real s111;
    Real s112;
    Real s113;
    Real s114;
    Real s115;
    Real s116;
    Real s117;
    Real s118;
    Real s119;

initial equation
    s1 = 1500000.0;
    s2 = 2830000.0;
    s3 = 117.2;
    s4 = 3870.0;
    s5 = 0.0;
    s6 = 0.0;
    s7 = 0.0;
    s8 = 0.0;
    s9 = 0.0;
    s10 = 0.0;
    s11 = 0.0;
    s12 = 0.0;
    s13 = 0.0;
    s14 = 0.246;
    s15 = 150.0;
    s16 = 167.616;
    s17 = 0.345;
    s18 = 0.1;
    s19 = 6967.271;
    s20 = 0.03;
    s21 = 0.0;
    s22 = 99.97;
    s23 = 0.0;
    s24 = 3.0;
    s25 = 999.754;
    s26 = 1.457;
    s27 = 1.723;
    s28 = 29.203;
    s35 = 0.0;
    s37 = 10000.0;
    s38 = 0.0;
    s39 = 0.0;
    s42 = 50.0;
    s43 = 0.006;
    s44 = 0.0;
    s45 = 0.0415;
    s47 = 2.827;
    s48 = 347.52;
    s49 = 10.0;
    s50 = 2.12;
    s51 = 34.98;
    s52 = 7635.36;
    s57 = 199987.0;
    s58 = 1.037;
    s60 = 0.0089;
    s61 = 10.98;
    s62 = 0.106;
    s63 = 500000.0;
    s64 = 0.0;
    s65 = 0.643;
    s66 = 0.083;
    s91 = 819.25;
    s92 = 18.0;
    s93 = 0.605;
    s94 = 72.0;
    s95 = 57.0;
    s96 = 299.706;
    s97 = 98.514;
    s98 = 157.162;
    s99 = 299.997;
    s100 = 0.288;
    s101 = 1.486;
    s102 = 0.616;
    s103 = 119.384;
    s104 = 0.003;
    s105 = 0.0;
    s106 = 3.214;
    s107 = 0.0;
    s108 = 0.0;
    s110 = 0.857;
    s111 = 3.23;
    s112 = 15.962;
    s113 = 5.577;
    s114 = 1.193;
    s115 = 0.09;
    s116 = 0.0;
    s117 = 0.0;
    s118 = 0.0;
    s119 = 0.0;

equation

    der(s1) = 0.0;
    der(s2) = (k_CCE * (fracK * Cao / (K3 + Cao) - s2) * (s1 - s2)) - (0.5 * k3 * (k_CICR * s3 / (K_CICR + s3)) * pow(s6 / (K2 + s6), 3) * s2 - 0.5 * k4 * pow(s3 / (K3 + s3), 2) + 0.5 * k5 * s2 * s2);
    der(s3) = ((-k6 * s3 * (B_T - s4) + k7 * s4)) + (0.5 * k3 * (k_CICR * s3 / (K_CICR + s3)) * pow(s6 / (K2 + s6), 3) * s2 - 0.5 * k4 * pow(s3 / (K3 + s3), 2) + 0.5 * k5 * s2 * s2) + (0.5 * dot_q_inpass) - (0.5 * dot_Vhi * pow(s3, 4) / (pow(K_hi, 4) + pow(s3, 4))) - (0.5 * dot_Vex * s3 / (K5 + s3)) - (0.5 * dot_Vp * pow(s3, 2) / (pow(K4, 2) + pow(s3, 2)));
    der(s4) =  - (-k6 * s3 * (B_T - s4) + k7 * s4);
    der(s5) =  - (k_CCE * (fracK * Cao / (K3 + Cao) - s2) * (s1 - s2));
    der(s6) = (0.5 * k1 * (R_T - half * R_T * (exp(-s12 / tau_I) + exp(-s12 / tau_II) + (exp(-s12 / tau_I) - exp(-s12 / tau_II)) * (tau_I + tau_II) / (tau_I - tau_II))) * s3 / (K1 + s3)) - (0.5 * k2 * s6);
    der(s7) =  - (0.5 * k1 * (R_T - half * R_T * (exp(-s12 / tau_I) + exp(-s12 / tau_II) + (exp(-s12 / tau_I) - exp(-s12 / tau_II)) * (tau_I + tau_II) / (tau_I - tau_II))) * s3 / (K1 + s3));
    der(s8) = (0.5 * k2 * s6) ;
    der(s9) = (0.5 * dot_Vhi * pow(s3, 4) / (pow(K_hi, 4) + pow(s3, 4))) + (0.5 * dot_Vp * pow(s3, 2) / (pow(K4, 2) + pow(s3, 2))) ;
    der(s10) = (0.5 * dot_Vex * s3 / (K5 + s3)) ;
    der(s11) =  - (0.5 * dot_q_inpass);
    der(s12) = (unisec_8 * 0.5) ;
    der(s13) =  - (unisec_8 * 0.5);
    der(s14) = (k66_30 * s17 * s25) - (s14 * k67_31);
    der(s15) = 0.0;
    der(s16) = (k65_29 * s27 * s15 / (Km65_29 + s27)) - (k60_24 * s17 * s16 - kr60_24 * s28);
    der(s17) = (k58_22 * s19 * s20 / (Km58_22 + s19)) + (k65_29 * s27 * s15 / (Km65_29 + s27)) - (k59_23 * s17 * s18 / (Km59_23 + s17)) - (k60_24 * s17 * s16 - kr60_24 * s28);
    der(s18) = 0.0;
    der(s19) = (k59_23 * s17 * s18 / (Km59_23 + s17)) - (k58_22 * s19 * s20 / (Km58_22 + s19));
    der(s20) = (exp(unity_21 - pow(s23 / tf_21, 1.8)) * normal_21 * pow(s23 / unimol_21, 0.8) * (unity_21 - pow(s23 / tf_21, 1.8))) ;
    der(s21) =  - (unitime_32);
    der(s22) =  - (exp(unity_21 - pow(s23 / tf_21, 1.8)) * normal_21 * pow(s23 / unimol_21, 0.8) * (unity_21 - pow(s23 / tf_21, 1.8)));
    der(s23) = (unitime_32) ;
    der(s24) = 0.0;
    der(s25) = (s14 * k67_31) - (k66_30 * s17 * s25);
    der(s26) = (k61_25 * s28 * s14 / (Km61_25 + s28)) + (k64_28 * s27 * s15 / (Km64_28 + s27)) - (k62_26 * s26 * s24 / (Km62_26 + s26)) - (k63_27 * s26 * s15 / (Km63_27 + s26));
    der(s27) = (k62_26 * s26 * s24 / (Km62_26 + s26)) - (k64_28 * s27 * s15 / (Km64_28 + s27)) - (k65_29 * s27 * s15 / (Km65_29 + s27));
    der(s28) = (k60_24 * s17 * s16 - kr60_24 * s28) + (k63_27 * s26 * s15 / (Km63_27 + s26)) - (k61_25 * s28 * s14 / (Km61_25 + s28));
    der(s35) = (kD_55 * s106) ;
    der(s37) =  - (kP_56 * s106 / (s106 + K30_56));
    der(s38) =  - (unitime_57);
    der(s39) = (unitime_57) ;
    der(s42) = (V44_63 * s107 / (s107 + K44_63)) - (s44 * s42 * k43_62 / (K43_62 + s42));
    der(s43) = (k38_59 * s100 * s101 / (K38_59 + s100)) - (V37_58 * s43 / (s43 + K37_58));
    der(s44) = (k40_61 * s104 * s43 / (K40_61 + s104)) - (V39_60 * s44 / (K39_60 + s44));
    der(s45) = (k15 * s47 * s51) - (gam * k14 * s45 - k13 * s3 * s50) - (k90 * s45 * s57) - (kDD * s45);
    der(s47) = (k13 * s3 * s48 - k14 * s47) + (kDD * s45) + (kDD * s58) + (kDD * s60) - (k15 * s47 * s51);
    der(s48) = (k11 * s3 * s52 - k12 * s48) + (k18 * s62 - k17 * s65 * s48) + (kDD * s50) + (kDD * s61) + (kDD * s62) - (k17 * s51 * s48 - k18 * s50) - (k13 * s3 * s48 - k14 * s47);
    der(s49) = (exp(tau_64 * (delay_64 - s39 / tc_64)) / (1 + 2 * exp(tau_64 * (delay_64 - s39 / tc_64)) + exp(2 * tau_64 * (delay_64 - s39 / tc_64))) / uc_64 * 29.256) ;
    der(s50) = (k17 * s51 * s48 - k18 * s50) + (gam * k14 * s45 - k13 * s3 * s50) + (kr90 * s61) - (kDD * s50);
    der(s51) = (kr90 * s66) + (kP_56 * s106 / (s106 + K30_56)) - (k15 * s47 * s51) - (k17 * s51 * s48 - k18 * s50) - (kDD * s51);
    der(s52) =  - (k11 * s3 * s52 - k12 * s48);
    der(s57) = (kr90 * s61) + (kr90 * s66) + (kDD * s66) + (kDD * s65) + (kDD * s61) + (kDD * s62) + (kDD * s58) + (kDD * s60) - (k90 * s45 * s57);
    der(s58) = (k90 * s45 * s57) - (gam * k14 * s58 - k13 * s3 * s61) - (kp * s58 * s27 / (s58 + Kmp) - Vdp * s60 / (s60 + Kmdp)) - (kDD * s58);
    der(s60) = (kp * s58 * s27 / (s58 + Kmp) - Vdp * s60 / (s60 + Kmdp)) - (gam * k14 * s60 - k13 * s3 * s62) - (kDD * s60);
    der(s61) = (gam * k14 * s58 - k13 * s3 * s61) - (kr90 * s61) - (kp * s61 * s27 / (s61 + Kmp) - Vdp * s62 / (s62 + Kmdp)) - (kDD * s61);
    der(s62) = (gam * k14 * s60 - k13 * s3 * s62) + (kp * s61 * s27 / (s61 + Kmp) - Vdp * s62 / (s62 + Kmdp)) - (k18 * s62 - k17 * s65 * s48) - (kDD * s62);
    der(s63) =  - (K_cam_no_33 * (s45 + s58) + K_p_no_33 * (s62 + s65) + K_pcam_no_33 * s60);
    der(s64) = (K_cam_no_33 * (s45 + s58) + K_p_no_33 * (s62 + s65) + K_pcam_no_33 * s60) ;
    der(s65) = (k18 * s62 - k17 * s65 * s48) - (Vdp * s65 / (s65 + Kmdp)) - (kDD * s65);
    der(s66) = (Vdp * s65 / (s65 + Kmdp)) - (kr90 * s66) - (kDD * s66);
    der(s91) = (V10_43 * s98 / (K10_43 + s98)) - (k105_39 * s91 * s93 - k_105_39 * s110);
    der(s92) = (exp(unity_38 - pow(s39 / tf_38, 1.3)) * normal_38 * pow(s39 / unimol_38, 0.3) * (unity_38 - pow(s39 / tf_38, 1.3))) ;
    der(s93) = (exp(unity_37 - pow(s39 / tf_37, 0.35)) * normal_37 * pow((s39 + tiny_num_37) / unimol_37, -0.65) * (unity_37 - pow(s39 / tf_37, 0.35))) + (k108_42 * s113 - k_108_42 * s93 * s114) - (k105_39 * s91 * s93 - k_105_39 * s110);
    der(s94) =  - (exp(unity_38 - pow(s39 / tf_38, 1.3)) * normal_38 * pow(s39 / unimol_38, 0.3) * (unity_38 - pow(s39 / tf_38, 1.3)));
    der(s95) =  - (exp(unity_37 - pow(s39 / tf_37, 0.35)) * normal_37 * pow((s39 + tiny_num_37) / unimol_37, -0.65) * (unity_37 - pow(s39 / tf_37, 0.35)));
    der(s96) = (V20_52 * s100 / (s100 + K20_52)) - (k19_51 * s101 * s96 / (K19_51 + s96));
    der(s97) = (V18_50 * s101 / (K18_50 + s101)) - (k113_49 * s102 * s97 / (K113_49 + s97));
    der(s98) = (k9_44 * s114) - (V10_43 * s98 / (K10_43 + s98));
    der(s99) = (V22_54 * s104 / (s104 + K22_54)) - (k21_53 * s99 * s43 / (s99 + K21_53));
    der(s100) = (k19_51 * s101 * s96 / (K19_51 + s96)) + (V37_58 * s43 / (s43 + K37_58)) - (V20_52 * s100 / (s100 + K20_52)) - (k38_59 * s100 * s101 / (K38_59 + s100));
    der(s101) = (k113_49 * s102 * s97 / (K113_49 + s97)) - (V18_50 * s101 / (K18_50 + s101));
    der(s102) = (k111_47 * s114 * s103 / (s103 + K111_47)) - (V12_48 * s102 / (K12_48 + s102));
    der(s103) = (V12_48 * s102 / (K12_48 + s102)) - (k111_47 * s114 * s103 / (s103 + K111_47));
    der(s104) = (k21_53 * s99 * s43 / (s99 + K21_53)) + (V39_60 * s44 / (K39_60 + s44)) - (V22_54 * s104 / (s104 + K22_54)) - (k40_61 * s104 * s43 / (K40_61 + s104));
    der(s105) =  - (exp(tau_64 * (delay_64 - s39 / tc_64)) / (1 + 2 * exp(tau_64 * (delay_64 - s39 / tc_64)) + exp(2 * tau_64 * (delay_64 - s39 / tc_64))) / uc_64 * 29.256);
    der(s106) = (s115 * kT_45) - (kD_55 * s106);
    der(s107) = (s44 * s42 * k43_62 / (K43_62 + s42)) - (V44_63 * s107 / (s107 + K44_63));
    der(s108) =  - (ktr1_46 * s107 + ktr1_46k2 * s49);
    der(s110) = (k105_39 * s91 * s93 - k_105_39 * s110) - (kcat_src_40 * s110 * s92 - k_6_40 * s112);
    der(s111) = (k9_44 * s114) - (k107_41 * s111 * s112 - k_107_41 * s113);
    der(s112) = (kcat_src_40 * s110 * s92 - k_6_40 * s112) - (k107_41 * s111 * s112 - k_107_41 * s113);
    der(s113) = (k107_41 * s111 * s112 - k_107_41 * s113) - (k108_42 * s113 - k_108_42 * s93 * s114);
    der(s114) = (k108_42 * s113 - k_108_42 * s93 * s114) - (k9_44 * s114);
    der(s115) = (ktr1_46 * s107 + ktr1_46k2 * s49) - (s115 * kT_45);
    der(s116) = (kDD * s51) ;
    der(s117) = (kDD * s45) + (kDD * s50) ;
    der(s118) = (kDD * s66) + (kDD * s65) ;
    der(s119) = 0.0;




end BIOMD468;
