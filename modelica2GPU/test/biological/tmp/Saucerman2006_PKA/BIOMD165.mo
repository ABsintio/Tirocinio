
model BIOMD165 "Saucerman2006_PKA"

    function pow
        input  Real x;
        input  Real power;
        output Real y;
        algorithm
            y := x^power;
    end pow;

    parameter Real k_ac_gsa_cAMP_synthesis_GsAC = 2.5;
    parameter Real ton_global_light_cAMP_photolysis = 2160.0;
    parameter Real toff_global_light_cAMP_photolysis = 2165.0;
    parameter Real ton_local_light_cAMP_photolysis = 0.0;
    parameter Real toff_local_light_cAMP_photolysis = 0.0;
    parameter Real kfsk_cAMP_synthesis_FskAC = 7.3;
    parameter Real t_propadd = 2420.0;
    parameter Real Propranolol_pipette = 1.0;
    parameter Real tauPropranolol = 1.0;
    parameter Real t_Ladd = 2160.0;
    parameter Real L_pipette = 0.1;
    parameter Real tauL = 1.0;
    parameter Real Km_cAMP_synthesis_GsAC = 315.0;
    parameter Real Kf_bind_b1AR_propranolol = 1000.0;
    parameter Real Kr_bind_b1AR_propranolol = 8.0;
    parameter Real kphot_cAMP_photolysis = 0.1;
    parameter Real k_gact_LRG_activation = 16.0;
    parameter Real Kf_bind_Lb1AR_Gs = 1000.0;
    parameter Real Kr_bind_Lb1AR_Gs = 62.0;
    parameter Real k_barkp_desens_bark = 0.0011;
    parameter Real Kf_bind_cAMP_ARC = 1000.0;
    parameter Real Kr_bind_cAMP_ARC = 1640.0;
    parameter Real Kf_bind_b1AR_Gs = 1000.0;
    parameter Real Kr_bind_b1AR_Gs = 33000.0;
    parameter Real Kf_bind_PDEcAMP = 1000.0;
    parameter Real Kr_bind_PDEcAMP = 1300.0;
    parameter Real khyd_Gs_gtp_hydrolysis = 0.8;
    parameter Real k_reassoc_Gs_reassociation = 1210.0;
    parameter Real Kf_bind_FskAC = 1000.0;
    parameter Real Kr_bind_FskAC = 860000.0;
    parameter Real Kf_bind_AKARp_PP = 1000.0;
    parameter Real Kr_bind_AKARp_PP = 7000.0;
    parameter Real kpkap_desens_pka = 0.0036;
    parameter Real kpkam_desens_pka = 0.0022;
    parameter Real Kf_bind_L_b1ARGs = 1000.0;
    parameter Real Kd_bind_L_b1ARGs = 0.535714;
    parameter Real Kf_bind_L_b1AR = 1000.0;
    parameter Real Kr_bind_L_b1AR = 285.0;
    parameter Real Kf_bind_A2R_PKAC = 4375.0;
    parameter Real Kr_bind_A2R_PKAC = 1000.0;
    parameter Real Kf_inhib_PKAC = 1000.0;
    parameter Real Kr_inhib_PKAC = 0.2;
    parameter Real Kf_bind_RC_cAMP = 1000.0;
    parameter Real Kr_bind_RC_cAMP = 9140.0;
    parameter Real Km_cAMP_synthesis_FskAC = 860.0;
    parameter Real Kf_bind_Gs_AC = 1000.0;
    parameter Real Kr_bind_Gs_AC = 400.0;
    parameter Real k_barkm_resens_bark = 0.0022;
    parameter Real Kf_bind_PKAC_AKAR = 1000.0;
    parameter Real Kr_bind_PKAC_AKAR = 21000.0;
    parameter Real kcat_PP_AKARp_AKARp_dephosph = 8.5;
    parameter Real kpka_akar_AKAR_phosph = 54.0;
    parameter Real k_gact_RG_activation = 16.0;
    parameter Real kpde_cAMP_degradation = 5.0;

    Real Vmax_cAMP_synthesis_GsAC(start=0.0);
    Real light_cAMP_photolysis(start=0.0);
    Real Vmax_cAMP_synthesis_FskAC(start=0.0);
    Real Kf_inhibit_PDE(start=0.0);
    Real Kr_inhibit_PDE(start=0.0);
    Real ar_for_add_propranolol(start=0.0);
    Real ar_for_add_Ligand(start=0.0);
    Real Ratio_AKARp_AKARtot(start=0.0);

    Real Gsbg_cell;
    Real L_cell;
    Real Gsa_gdp_cell;
    Real Gsa_gtp_cell;
    Real b1AR_S464_cell;
    Real PDEcAMP_cell;
    Real PDE_cell;
    Real ATP_cell;
    Real b1AR_cell;
    Real Gs_cell;
    Real A2RC_cell;
    Real A2R_cell;
    Real PKAC_cell;
    Real ARC_cell;
    Real PKAC_AKAR_cell;
    Real Propranolol_cell;
    Real b1ARinhib_cell;
    Real light_spot_cell;
    Real AC_cell;
    Real PKI_cell;
    Real PKAC_PKI_cell;
    Real RC_cell;
    Real b1AR_Gs_cell;
    Real cAMP_cell;
    Real GsAC_cell;
    Real IBMX_cell;
    Real PDE_IBMX_cell;
    Real Fsk_cell;
    Real FskAC_cell;
    Real b1AR_p_cell;
    Real L_b1AR_cell;
    Real AKAR_cell;
    Real AKARp_cell;
    Real PP_cell;
    Real PP_AKARp_cell;
    Real DMNB_cAMP_cell;
    Real L_b1AR_Gs_cell;

initial equation
    Gsbg_cell = 0.0;
    L_cell = 0.0;
    Gsa_gdp_cell = 0.0;
    Gsa_gtp_cell = 0.0;
    b1AR_S464_cell = 0.0;
    PDEcAMP_cell = 0.0;
    PDE_cell = 0.014;
    ATP_cell = 5000.0;
    b1AR_cell = 0.0132;
    Gs_cell = 3.83;
    A2RC_cell = 0.0;
    A2R_cell = 0.0;
    PKAC_cell = 0.0;
    ARC_cell = 0.0;
    PKAC_AKAR_cell = 0.0;
    Propranolol_cell = 0.0;
    b1ARinhib_cell = 0.0;
    light_spot_cell = 0.0;
    AC_cell = 0.0497;
    PKI_cell = 0.18;
    PKAC_PKI_cell = 0.0;
    RC_cell = 1.18;
    b1AR_Gs_cell = 0.0;
    cAMP_cell = 0.0;
    GsAC_cell = 0.0;
    IBMX_cell = 0.0;
    PDE_IBMX_cell = 0.0;
    Fsk_cell = 0.0;
    FskAC_cell = 0.0;
    b1AR_p_cell = 0.0;
    L_b1AR_cell = 0.0;
    AKAR_cell = 10.0;
    AKARp_cell = 0.0;
    PP_cell = 0.67;
    PP_AKARp_cell = 0.0;
    DMNB_cAMP_cell = 3.01;
    L_b1AR_Gs_cell = 0.0;

equation
    Vmax_cAMP_synthesis_GsAC = k_ac_gsa_cAMP_synthesis_GsAC * GsAC_1.0;
    light_cAMP_photolysis = pi1.0ewise(1, and(gt(t, ton_global_light_cAMP_photolysis), lt(t, toff_global_light_cAMP_photolysis)), 0) + pi1.0ewise(light_spot_1.0, and(gt(t, ton_local_light_cAMP_photolysis), lt(t, toff_local_light_cAMP_photolysis)), 0);
    Vmax_cAMP_synthesis_FskAC = kfsk_cAMP_synthesis_FskAC * FskAC_1.0;
    Kf_inhibit_PDE = pi1.0ewise(1000, gt(t, 1000), 0);
    Kr_inhibit_PDE = pi1.0ewise(30000, gt(t, 1000), 0);
    ar_for_add_propranolol = pi1.0ewise((Propranolol_pipette + -Propranolol_1.0) * (1 / tauPropranolol), gt(t, t_propadd), 0);
    ar_for_add_Ligand = pi1.0ewise((L_pipette + -L_1.0) * (1 / tauL), gt(t, t_Ladd), 0);
    Ratio_AKARp_AKARtot = AKARp_1.0 / (AKAR_1.0 + AKARp_1.0 + PKAC_AKAR_1.0 + PP_AKARp_1.0);
    der(Gsbg_1.0) = (k_gact_LRG_activation * L_b1AR_Gs_1.0 * 1.0) + (k_gact_RG_activation * b1AR_Gs_1.0 * 1.0) - (k_reassoc_Gs_reassociation * Gsa_gdp_1.0 * Gsbg_1.0 * 1.0);
    der(L_1.0) = (ar_for_add_Ligand * 1.0) - ((Kf_bind_L_b1ARGs * b1AR_Gs_1.0 * L_1.0 + -(Kd_bind_L_b1ARGs * L_b1AR_Gs_1.0)) * 1.0) - ((Kf_bind_L_b1AR * L_1.0 * b1AR_1.0 + -(Kr_bind_L_b1AR * L_b1AR_1.0)) * 1.0);
    der(Gsa_gdp_1.0) = (khyd_Gs_gtp_hydrolysis * Gsa_gtp_1.0 * 1.0) - (k_reassoc_Gs_reassociation * Gsa_gdp_1.0 * Gsbg_1.0 * 1.0);
    der(Gsa_gtp_1.0) = (k_gact_LRG_activation * L_b1AR_Gs_1.0 * 1.0) + (k_gact_RG_activation * b1AR_Gs_1.0 * 1.0) - (khyd_Gs_gtp_hydrolysis * Gsa_gtp_1.0 * 1.0) - ((Kf_bind_Gs_AC * Gsa_gtp_1.0 * AC_1.0 + -(Kr_bind_Gs_AC * GsAC_1.0)) * 1.0);
    der(b1AR_S464_1.0) = (k_barkp_desens_bark * (L_b1AR_1.0 + L_b1AR_Gs_1.0) * 1.0) - (k_barkm_resens_bark * b1AR_S464_1.0 * 1.0);
    der(PDEcAMP_1.0) = ((Kf_bind_PDEcAMP * PDE_1.0 * cAMP_1.0 + -(Kr_bind_PDEcAMP * PDEcAMP_1.0)) * 1.0) - (kpde_cAMP_degradation * PDEcAMP_1.0 * 1.0);
    der(PDE_1.0) = (kpde_cAMP_degradation * PDEcAMP_1.0 * 1.0) - ((Kf_bind_PDEcAMP * PDE_1.0 * cAMP_1.0 + -(Kr_bind_PDEcAMP * PDEcAMP_1.0)) * 1.0) - ((Kf_inhibit_PDE * PDE_1.0 * IBMX_1.0 + -(Kr_inhibit_PDE * PDE_IBMX_1.0)) * 1.0);
    der(ATP_1.0) = 0.0;
    der(b1AR_1.0) = (k_gact_RG_activation * b1AR_Gs_1.0 * 1.0) - ((Kf_bind_b1AR_propranolol * Propranolol_1.0 * b1AR_1.0 + -(Kr_bind_b1AR_propranolol * b1ARinhib_1.0)) * 1.0) - ((Kf_bind_b1AR_Gs * b1AR_1.0 * Gs_1.0 + -(Kr_bind_b1AR_Gs * b1AR_Gs_1.0)) * 1.0) - ((kpkap_desens_pka * PKAC_1.0 * (L_b1AR_Gs_1.0 + b1AR_1.0 + L_b1AR_1.0) + -(kpkam_desens_pka * b1AR_p_1.0)) * 1.0) - ((Kf_bind_L_b1AR * L_1.0 * b1AR_1.0 + -(Kr_bind_L_b1AR * L_b1AR_1.0)) * 1.0);
    der(Gs_1.0) = (k_reassoc_Gs_reassociation * Gsa_gdp_1.0 * Gsbg_1.0 * 1.0) - ((Kf_bind_Lb1AR_Gs * Gs_1.0 * L_b1AR_1.0 + -(Kr_bind_Lb1AR_Gs * L_b1AR_Gs_1.0)) * 1.0) - ((Kf_bind_b1AR_Gs * b1AR_1.0 * Gs_1.0 + -(Kr_bind_b1AR_Gs * b1AR_Gs_1.0)) * 1.0);
    der(A2RC_1.0) = ((Kf_bind_cAMP_ARC * ARC_1.0 * cAMP_1.0 + -(Kr_bind_cAMP_ARC * A2RC_1.0)) * 1.0) - ((Kf_bind_A2R_PKAC * A2RC_1.0 + -(Kr_bind_A2R_PKAC * A2R_1.0 * PKAC_1.0)) * 1.0);
    der(A2R_1.0) = ((Kf_bind_A2R_PKAC * A2RC_1.0 + -(Kr_bind_A2R_PKAC * A2R_1.0 * PKAC_1.0)) * 1.0) ;
    der(PKAC_1.0) = ((Kf_bind_A2R_PKAC * A2RC_1.0 + -(Kr_bind_A2R_PKAC * A2R_1.0 * PKAC_1.0)) * 1.0) + (kpka_akar_AKAR_phosph * PKAC_AKAR_1.0 * 1.0) - ((Kf_inhib_PKAC * PKAC_1.0 * PKI_1.0 + -(Kr_inhib_PKAC * PKAC_PKI_1.0)) * 1.0) - ((Kf_bind_PKAC_AKAR * AKAR_1.0 * PKAC_1.0 + -(Kr_bind_PKAC_AKAR * PKAC_AKAR_1.0)) * 1.0);
    der(ARC_1.0) = ((Kf_bind_RC_cAMP * RC_1.0 * cAMP_1.0 + -(Kr_bind_RC_cAMP * ARC_1.0)) * 1.0) - ((Kf_bind_cAMP_ARC * ARC_1.0 * cAMP_1.0 + -(Kr_bind_cAMP_ARC * A2RC_1.0)) * 1.0);
    der(PKAC_AKAR_1.0) = ((Kf_bind_PKAC_AKAR * AKAR_1.0 * PKAC_1.0 + -(Kr_bind_PKAC_AKAR * PKAC_AKAR_1.0)) * 1.0) - (kpka_akar_AKAR_phosph * PKAC_AKAR_1.0 * 1.0);
    der(Propranolol_1.0) = (ar_for_add_propranolol * 1.0) - ((Kf_bind_b1AR_propranolol * Propranolol_1.0 * b1AR_1.0 + -(Kr_bind_b1AR_propranolol * b1ARinhib_1.0)) * 1.0);
    der(b1ARinhib_1.0) = ((Kf_bind_b1AR_propranolol * Propranolol_1.0 * b1AR_1.0 + -(Kr_bind_b1AR_propranolol * b1ARinhib_1.0)) * 1.0) ;
    der(light_spot_1.0) = 0.0;
    der(AC_1.0) =  - ((Kf_bind_FskAC * AC_1.0 * Fsk_1.0 + -(Kr_bind_FskAC * FskAC_1.0)) * 1.0) - ((Kf_bind_Gs_AC * Gsa_gtp_1.0 * AC_1.0 + -(Kr_bind_Gs_AC * GsAC_1.0)) * 1.0);
    der(PKI_1.0) =  - ((Kf_inhib_PKAC * PKAC_1.0 * PKI_1.0 + -(Kr_inhib_PKAC * PKAC_PKI_1.0)) * 1.0);
    der(PKAC_PKI_1.0) = ((Kf_inhib_PKAC * PKAC_1.0 * PKI_1.0 + -(Kr_inhib_PKAC * PKAC_PKI_1.0)) * 1.0) ;
    der(RC_1.0) =  - ((Kf_bind_RC_cAMP * RC_1.0 * cAMP_1.0 + -(Kr_bind_RC_cAMP * ARC_1.0)) * 1.0);
    der(b1AR_Gs_1.0) = ((Kf_bind_b1AR_Gs * b1AR_1.0 * Gs_1.0 + -(Kr_bind_b1AR_Gs * b1AR_Gs_1.0)) * 1.0) - ((Kf_bind_L_b1ARGs * b1AR_Gs_1.0 * L_1.0 + -(Kd_bind_L_b1ARGs * L_b1AR_Gs_1.0)) * 1.0) - (k_gact_RG_activation * b1AR_Gs_1.0 * 1.0);
    der(cAMP_1.0) = (Vmax_cAMP_synthesis_GsAC * ATP_1.0 * (1 / (Km_cAMP_synthesis_GsAC + ATP_1.0)) * 1.0) + (kphot_cAMP_photolysis * light_cAMP_photolysis * DMNB_cAMP_1.0 * 1.0) + (Vmax_cAMP_synthesis_FskAC * ATP_1.0 * (1 / (Km_cAMP_synthesis_FskAC + ATP_1.0)) * 1.0) - ((Kf_bind_cAMP_ARC * ARC_1.0 * cAMP_1.0 + -(Kr_bind_cAMP_ARC * A2RC_1.0)) * 1.0) - ((Kf_bind_PDEcAMP * PDE_1.0 * cAMP_1.0 + -(Kr_bind_PDEcAMP * PDEcAMP_1.0)) * 1.0) - ((Kf_bind_RC_cAMP * RC_1.0 * cAMP_1.0 + -(Kr_bind_RC_cAMP * ARC_1.0)) * 1.0);
    der(GsAC_1.0) = ((Kf_bind_Gs_AC * Gsa_gtp_1.0 * AC_1.0 + -(Kr_bind_Gs_AC * GsAC_1.0)) * 1.0) ;
    der(IBMX_1.0) =  - ((Kf_inhibit_PDE * PDE_1.0 * IBMX_1.0 + -(Kr_inhibit_PDE * PDE_IBMX_1.0)) * 1.0);
    der(PDE_IBMX_1.0) = ((Kf_inhibit_PDE * PDE_1.0 * IBMX_1.0 + -(Kr_inhibit_PDE * PDE_IBMX_1.0)) * 1.0) ;
    der(Fsk_1.0) =  - ((Kf_bind_FskAC * AC_1.0 * Fsk_1.0 + -(Kr_bind_FskAC * FskAC_1.0)) * 1.0);
    der(FskAC_1.0) = ((Kf_bind_FskAC * AC_1.0 * Fsk_1.0 + -(Kr_bind_FskAC * FskAC_1.0)) * 1.0) ;
    der(b1AR_p_1.0) = ((kpkap_desens_pka * PKAC_1.0 * (L_b1AR_Gs_1.0 + b1AR_1.0 + L_b1AR_1.0) + -(kpkam_desens_pka * b1AR_p_1.0)) * 1.0) ;
    der(L_b1AR_1.0) = (k_gact_LRG_activation * L_b1AR_Gs_1.0 * 1.0) + ((Kf_bind_L_b1AR * L_1.0 * b1AR_1.0 + -(Kr_bind_L_b1AR * L_b1AR_1.0)) * 1.0) + (k_barkm_resens_bark * b1AR_S464_1.0 * 1.0) - ((Kf_bind_Lb1AR_Gs * Gs_1.0 * L_b1AR_1.0 + -(Kr_bind_Lb1AR_Gs * L_b1AR_Gs_1.0)) * 1.0) - (k_barkp_desens_bark * (L_b1AR_1.0 + L_b1AR_Gs_1.0) * 1.0);
    der(AKAR_1.0) = (kcat_PP_AKARp_AKARp_dephosph * PP_AKARp_1.0 * 1.0) - ((Kf_bind_PKAC_AKAR * AKAR_1.0 * PKAC_1.0 + -(Kr_bind_PKAC_AKAR * PKAC_AKAR_1.0)) * 1.0);
    der(AKARp_1.0) = (kpka_akar_AKAR_phosph * PKAC_AKAR_1.0 * 1.0) - ((Kf_bind_AKARp_PP * PP_1.0 * AKARp_1.0 + -(Kr_bind_AKARp_PP * PP_AKARp_1.0)) * 1.0);
    der(PP_1.0) = (kcat_PP_AKARp_AKARp_dephosph * PP_AKARp_1.0 * 1.0) - ((Kf_bind_AKARp_PP * PP_1.0 * AKARp_1.0 + -(Kr_bind_AKARp_PP * PP_AKARp_1.0)) * 1.0);
    der(PP_AKARp_1.0) = ((Kf_bind_AKARp_PP * PP_1.0 * AKARp_1.0 + -(Kr_bind_AKARp_PP * PP_AKARp_1.0)) * 1.0) - (kcat_PP_AKARp_AKARp_dephosph * PP_AKARp_1.0 * 1.0);
    der(DMNB_cAMP_1.0) =  - (kphot_cAMP_photolysis * light_cAMP_photolysis * DMNB_cAMP_1.0 * 1.0);
    der(L_b1AR_Gs_1.0) = ((Kf_bind_Lb1AR_Gs * Gs_1.0 * L_b1AR_1.0 + -(Kr_bind_Lb1AR_Gs * L_b1AR_Gs_1.0)) * 1.0) + ((Kf_bind_L_b1ARGs * b1AR_Gs_1.0 * L_1.0 + -(Kd_bind_L_b1ARGs * L_b1AR_Gs_1.0)) * 1.0) - (k_gact_LRG_activation * L_b1AR_Gs_1.0 * 1.0);



end BIOMD165;
