
model BIOMD578 "Invergo2014 - Phototransduction cascade in mouse rod cells"

    function pow
        input  Real x;
        input  Real power;
        output Real y;
        algorithm
            y := x^power;
    end pow;
    
    function piecewise
        input Real x;
        input Boolean condition;
        input Real y;
        output Real z;
        algorithm
            z := if condition then x else y;
    end piecewise;



    parameter Real Rtot = 100000000.0;
    parameter Real PDEtot = 2000000.0;
    parameter Real Gtot = 10000000.0;
    parameter Real RGStot = 100000.0;
    parameter Real ArrTot = 7074600.0;
    parameter Real flashBG = 0.0;
    parameter Real flash0Dur = 0.001;
    parameter Real flash0Mag = 0.0;
    parameter Real flashDel = 0.0;
    parameter Real flashDur = 0.001;
    parameter Real flashMag = 0.0;
    parameter Real otherstimulus = 0.0;
    parameter Real kRK1_0 = 0.1724;
    parameter Real omega = 2.5;
    parameter Real kRK2 = 250.0;
    parameter Real kRK3_ATP = 4000.0;
    parameter Real kRK4 = 250.0;
    parameter Real kArr = 9.9147e-06;
    parameter Real kA2 = 0.026;
    parameter Real m_Arr = 9.5475e-06;
    parameter Real kA3 = 1.1651;
    parameter Real kA4 = 2.9965e-07;
    parameter Real kA5 = 0.424;
    parameter Real kOps = 6.1172e-13;
    parameter Real kRrecyc = 0.0007;
    parameter Real omega_G = 0.6;
    parameter Real kG1_0 = 0.001;
    parameter Real kG2 = 2200.0;
    parameter Real kG3 = 8500.0;
    parameter Real kG4_GDP = 400.0;
    parameter Real kG5_GTP = 3500.0;
    parameter Real kG6 = 8500.0;
    parameter Real kG7 = 200.0;
    parameter Real kGrecyc = 2.0;
    parameter Real kGshutoff = 0.05;
    parameter Real kP1 = 0.05497;
    parameter Real kP1_rev = 0.0;
    parameter Real kP2 = 940.7;
    parameter Real kP3 = 1.4983e-09;
    parameter Real kP4 = 21.088;
    parameter Real kPDEshutoff = 0.1;
    parameter Real kRGS1 = 4.8182e-05;
    parameter Real kRGS2 = 98.0;
    parameter Real kRec1 = 0.011;
    parameter Real kRec2 = 0.05;
    parameter Real kRec3 = 0.00041081;
    parameter Real kRec4 = 0.610084;
    parameter Real Vcyto = 0.03916;
    parameter Real Kc1 = 0.171;
    parameter Real Kc2 = 0.059;
    parameter Real m1 = 3.0;
    parameter Real m2 = 1.5;
    parameter Real alfamax = 60.0;
    parameter Real betadark = 3.19;
    parameter Real betasub = 0.0021826;
    parameter Real fCa = 0.12;
    parameter Real Jdark = 14.87;
    parameter Real F = 96485.34;
    parameter Real cGMPdark = 6.4944;
    parameter Real ncg = 3.8;
    parameter Real gammaCa = 981.3558;
    parameter Real Ca2dark = 0.25;
    parameter Real Ca2_0 = 0.023;
    parameter Real k1 = 9.37059;
    parameter Real k2 = 46.412;
    parameter Real eT = 400.0;
    parameter Real ktherm = 0.0238;
    parameter Real cytosol = 1.0;

    Real background(start=0.0);
    Real premag(start=0.0);
    Real mag(start=0.0);
    Real predur(start=0.0);
    Real dur(start=0.0);
    Real del(start=0.0);
    Real preflash(start=0.0);
    Real testflash(start=0.0);
    Real stimulus(start=0.0);
    Real numConcFactor(start=0.0);
    Real kRK1_1(start=0.0);
    Real kRK1_2(start=0.0);
    Real kRK1_3(start=0.0);
    Real kRK1_4(start=0.0);
    Real kRK1_5(start=0.0);
    Real kRK1_6(start=0.0);
    Real kA1_1(start=0.0);
    Real kA1_2(start=0.0);
    Real kA1_3(start=0.0);
    Real kA1_4(start=0.0);
    Real kA1_5(start=0.0);
    Real kA1_6(start=0.0);
    Real kGpre1(start=0.0);
    Real kGpre2(start=0.0);
    Real kG1ops(start=0.0);
    Real kG2ops(start=0.0);
    Real kG1_1(start=0.0);
    Real kG1_2(start=0.0);
    Real kG1_3(start=0.0);
    Real kG1_4(start=0.0);
    Real kG1_5(start=0.0);
    Real kG1_6(start=0.0);
    Real E(start=0.0);
    Real Ca2_frac(start=0.0);
    Real J(start=0.0);
    Real deltaJ(start=0.0);

    Real Arr;
    Real Arr_di;
    Real Arr_tetra;
    Real Ca2_buff;
    Real Ca2_free;
    Real G_GTP;
    Real Ga_GDP;
    Real Ga_GTP;
    Real Ga_GTP_PDE_a_Ga_GTP;
    Real Ga_GTP_a_PDE_a_Ga_GTP;
    Real Gbg;
    Real Gt;
    Real Ops;
    Real Ops_G;
    Real Ops_G_GTP;
    Real Ops_Gt;
    Real PDE;
    Real PDE_Ga_GTP;
    Real PDE_a_Ga_GTP;
    Real R;
    Real R0;
    Real R0_G;
    Real R0_G_GTP;
    Real R0_Gt;
    Real R0_RKpre;
    Real R1;
    Real R1_Arr;
    Real R1_G;
    Real R1_G_GTP;
    Real R1_Gt;
    Real R1_RKpost;
    Real R1_RKpre;
    Real R2;
    Real R2_Arr;
    Real R2_G;
    Real R2_G_GTP;
    Real R2_Gt;
    Real R2_RKpost;
    Real R2_RKpre;
    Real R3;
    Real R3_Arr;
    Real R3_G;
    Real R3_G_GTP;
    Real R3_Gt;
    Real R3_RKpost;
    Real R3_RKpre;
    Real R4;
    Real R4_Arr;
    Real R4_G;
    Real R4_G_GTP;
    Real R4_Gt;
    Real R4_RKpost;
    Real R4_RKpre;
    Real R5;
    Real R5_Arr;
    Real R5_G;
    Real R5_G_GTP;
    Real R5_Gt;
    Real R5_RKpost;
    Real R5_RKpre;
    Real R6;
    Real R6_Arr;
    Real R6_G;
    Real R6_G_GTP;
    Real R6_Gt;
    Real R6_RKpost;
    Real R6_RKpre;
    Real RGS;
    Real RGS_Ga_GTP_a_PDE_a_Ga_GTP;
    Real RGS_PDE_a_Ga_GTP;
    Real RK;
    Real R_Gt;
    Real RecR_Ca;
    Real RecR_Ca_RK;
    Real RecT;
    Real cGMP;

initial equation
    Arr = 1260760.0;
    Arr_di = 1123300.0;
    Arr_tetra = 891810.0;
    Ca2_buff = 19.2199;
    Ca2_free = 0.25;
    G_GTP = 0.0;
    Ga_GDP = 0.0;
    Ga_GTP = 0.0;
    Ga_GTP_PDE_a_Ga_GTP = 0.0;
    Ga_GTP_a_PDE_a_Ga_GTP = 0.0;
    Gbg = 0.0;
    Gt = 8152500.0;
    Ops = 0.0;
    Ops_G = 0.0;
    Ops_G_GTP = 0.0;
    Ops_Gt = 0.0;
    PDE = 2000000.0;
    PDE_Ga_GTP = 0.0;
    PDE_a_Ga_GTP = 0.0;
    R = 98152500.0;
    R0 = 0.0;
    R0_G = 0.0;
    R0_G_GTP = 0.0;
    R0_Gt = 0.0;
    R0_RKpre = 0.0;
    R1 = 0.0;
    R1_Arr = 0.0;
    R1_G = 0.0;
    R1_G_GTP = 0.0;
    R1_Gt = 0.0;
    R1_RKpost = 0.0;
    R1_RKpre = 0.0;
    R2 = 0.0;
    R2_Arr = 0.0;
    R2_G = 0.0;
    R2_G_GTP = 0.0;
    R2_Gt = 0.0;
    R2_RKpost = 0.0;
    R2_RKpre = 0.0;
    R3 = 0.0;
    R3_Arr = 0.0;
    R3_G = 0.0;
    R3_G_GTP = 0.0;
    R3_Gt = 0.0;
    R3_RKpost = 0.0;
    R3_RKpre = 0.0;
    R4 = 0.0;
    R4_Arr = 0.0;
    R4_G = 0.0;
    R4_G_GTP = 0.0;
    R4_Gt = 0.0;
    R4_RKpost = 0.0;
    R4_RKpre = 0.0;
    R5 = 0.0;
    R5_Arr = 0.0;
    R5_G = 0.0;
    R5_G_GTP = 0.0;
    R5_Gt = 0.0;
    R5_RKpost = 0.0;
    R5_RKpre = 0.0;
    R6 = 0.0;
    R6_Arr = 0.0;
    R6_G = 0.0;
    R6_G_GTP = 0.0;
    R6_Gt = 0.0;
    R6_RKpost = 0.0;
    R6_RKpre = 0.0;
    RGS = 100000.0;
    RGS_Ga_GTP_a_PDE_a_Ga_GTP = 0.0;
    RGS_PDE_a_Ga_GTP = 0.0;
    RK = 580.0;
    R_Gt = 1847500.0;
    RecR_Ca = 510930.0;
    RecR_Ca_RK = 199420.0;
    RecT = 9289650.0;
    cGMP = 6.4944;

equation
    background = flashBG;
    premag = flash0Mag / flash0Dur;
    mag = flashMag / flashDur;
    predur = flash0Dur;
    dur = flashDur;
    del = flashDel;
    preflash = piecewise(premag, leq(time, predur), 0);
    testflash = piecewise(mag, and(geq(time, del), leq(time, del + dur)), 0);
    stimulus = background + preflash + testflash + otherstimulus;
    numConcFactor = 1 / (6.022e5 * Vcyto);
    kRK1_1 = kRK1_0 * exp(-omega);
    kRK1_2 = kRK1_0 * exp(-omega * 2);
    kRK1_3 = kRK1_0 * exp(-omega * 3);
    kRK1_4 = kRK1_0 * exp(-omega * 4);
    kRK1_5 = kRK1_0 * exp(-omega * 5);
    kRK1_6 = 0;
    kA1_1 = kArr;
    kA1_2 = kArr + 1 * m_Arr;
    kA1_3 = kArr + 2 * m_Arr;
    kA1_4 = kArr + 3 * m_Arr;
    kA1_5 = kArr + 3 * m_Arr;
    kA1_6 = kArr + 3 * m_Arr;
    kGpre1 = kG1_0 * 1.6;
    kGpre2 = kG2 * 315;
    kG1ops = kG1_0 * 1.9;
    kG2ops = kG2 * 3;
    kG1_1 = kG1_0 * exp(-omega_G);
    kG1_2 = kG1_0 * exp(-omega_G * 2);
    kG1_3 = kG1_0 * exp(-omega_G * 3);
    kG1_4 = kG1_0 * exp(-omega_G * 4);
    kG1_5 = kG1_0 * exp(-omega_G * 5);
    kG1_6 = kG1_0 * exp(-omega_G * 6);
    E = PDE_a_Ga_GTP + 2 * Ga_GTP_a_PDE_a_Ga_GTP + Ga_GTP_PDE_a_Ga_GTP;
    Ca2_frac = (Ca2_free - Ca2_0) / (Ca2dark - Ca2_0);
    J = 2 / (2 + fCa) * pow(cGMP / cGMPdark, ncg) * Jdark + fCa / (fCa + 2) * Ca2_frac * Jdark;
    deltaJ = Jdark - J;
    der(Ca2_free) = -v_r33 - v_r34 + v_r35 - 2 * v_r30 * numConcFactor;
    der(Arr) = (kA3 * R1_Arr) + (kA3 * R2_Arr) + (kA3 * R3_Arr) + (kA3 * R4_Arr) + (kA3 * R5_Arr) + (kA3 * R6_Arr) - (kA1_1 * Arr * R1 - kA2 * R1_Arr) - (kA1_2 * Arr * R2 - kA2 * R2_Arr) - (kA1_3 * Arr * R3 - kA2 * R3_Arr) - (kA1_4 * Arr * R4 - kA2 * R4_Arr) - (kA1_5 * Arr * R5 - kA2 * R5_Arr) - (kA1_6 * Arr * R6 - kA2 * R6_Arr) - (2.0 * kA4 * Arr * Arr - kA5 * Arr_di);
    der(Arr_di) = (kA4 * Arr * Arr - kA5 * Arr_di) - (2.0 * kA4 * Arr_di * Arr_di - kA5 * Arr_tetra);
    der(Arr_tetra) = (kA4 * Arr_di * Arr_di - kA5 * Arr_tetra) ;
    der(Ca2_buff) = (k1 * (eT - Ca2_buff) * Ca2_free - k2 * Ca2_buff) ;
    der(G_GTP) = (kG6 * Ops_G_GTP) + (kG6 * R0_G_GTP) + (kG6 * R1_G_GTP) + (kG6 * R2_G_GTP) + (kG6 * R3_G_GTP) + (kG6 * R4_G_GTP) + (kG6 * R5_G_GTP) + (kG6 * R6_G_GTP) - (kG7 * G_GTP);
    der(Ga_GDP) = (kRGS2 * RGS_Ga_GTP_a_PDE_a_Ga_GTP) + (kRGS2 * RGS_PDE_a_Ga_GTP) + (kPDEshutoff * PDE_a_Ga_GTP) + (kPDEshutoff * Ga_GTP_a_PDE_a_Ga_GTP) + (kGshutoff * Ga_GTP) - (kGrecyc * Gbg * Ga_GDP);
    der(Ga_GTP) = (kG7 * G_GTP) - (kP1 * PDE * Ga_GTP - kP1_rev * PDE_Ga_GTP) - (kP3 * PDE_a_Ga_GTP * Ga_GTP) - (kGshutoff * Ga_GTP);
    der(Ga_GTP_PDE_a_Ga_GTP) = (kP3 * PDE_a_Ga_GTP * Ga_GTP) - (kP4 * Ga_GTP_PDE_a_Ga_GTP);
    der(Ga_GTP_a_PDE_a_Ga_GTP) = (kP4 * Ga_GTP_PDE_a_Ga_GTP) - (kRGS1 * RGS * Ga_GTP_a_PDE_a_Ga_GTP) - (kPDEshutoff * Ga_GTP_a_PDE_a_Ga_GTP);
    der(Gbg) = (kG7 * G_GTP) - (kGrecyc * Gbg * Ga_GDP);
    der(Gt) = (kGrecyc * Gbg * Ga_GDP) - (kG1ops * Ops * Gt - kG2ops * Ops_Gt) - (kGpre1 * Gt * R - kGpre2 * R_Gt) - (kG1_0 * Gt * R0 - kG2 * R0_Gt) - (kG1_1 * Gt * R1 - kG2 * R1_Gt) - (kG1_2 * Gt * R2 - kG2 * R2_Gt) - (kG1_3 * Gt * R3 - kG2 * R3_Gt) - (kG1_4 * Gt * R4 - kG2 * R4_Gt) - (kG1_5 * Gt * R5 - kG2 * R5_Gt) - (kG1_6 * Gt * R6 - kG2 * R6_Gt);
    der(Ops) = (kA3 * R1_Arr) + (kA3 * R2_Arr) + (kA3 * R3_Arr) + (kA3 * R4_Arr) + (kA3 * R5_Arr) + (kA3 * R6_Arr) + (ktherm * R0) + (ktherm * R1) + (ktherm * R2) + (ktherm * R3) + (ktherm * R4) + (ktherm * R5) + (ktherm * R6) + (kG6 * Ops_G_GTP) - (kG1ops * Ops * Gt - kG2ops * Ops_Gt) - (kRrecyc * Ops);
    der(Ops_G) = (kOps * Ops_Gt - kG4_GDP * Ops_G) - (kG5_GTP * Ops_G);
    der(Ops_G_GTP) = (kG5_GTP * Ops_G) - (kG6 * Ops_G_GTP);
    der(Ops_Gt) = (kG1ops * Ops * Gt - kG2ops * Ops_Gt) - (kOps * Ops_Gt - kG4_GDP * Ops_G);
    der(PDE) = (kRGS2 * RGS_PDE_a_Ga_GTP) + (kPDEshutoff * PDE_a_Ga_GTP) - (kP1 * PDE * Ga_GTP - kP1_rev * PDE_Ga_GTP);
    der(PDE_Ga_GTP) = (kP1 * PDE * Ga_GTP - kP1_rev * PDE_Ga_GTP) - (kP2 * PDE_Ga_GTP);
    der(PDE_a_Ga_GTP) = (kP2 * PDE_Ga_GTP) + (kRGS2 * RGS_Ga_GTP_a_PDE_a_Ga_GTP) + (kPDEshutoff * Ga_GTP_a_PDE_a_Ga_GTP) - (kP3 * PDE_a_Ga_GTP * Ga_GTP) - (kRGS1 * RGS * PDE_a_Ga_GTP) - (kPDEshutoff * PDE_a_Ga_GTP);
    der(R) = (kRrecyc * Ops) - (stimulus * R / Rtot) - (kGpre1 * Gt * R - kGpre2 * R_Gt);
    der(R0) = (stimulus * R / Rtot) + (kG6 * R0_G_GTP) - (kRK1_0 * RK * R0 - kRK2 * R0_RKpre) - (ktherm * R0) - (kG1_0 * Gt * R0 - kG2 * R0_Gt);
    der(R0_G) = (kG3 * R0_Gt - kG4_GDP * R0_G) - (kG5_GTP * R0_G);
    der(R0_G_GTP) = (kG5_GTP * R0_G) - (kG6 * R0_G_GTP);
    der(R0_Gt) = (stimulus * R_Gt / Rtot) + (kG1_0 * Gt * R0 - kG2 * R0_Gt) - (kG3 * R0_Gt - kG4_GDP * R0_G);
    der(R0_RKpre) = (kRK1_0 * RK * R0 - kRK2 * R0_RKpre) - (kRK3_ATP * R0_RKpre);
    der(R1) = (kRK4 * R1_RKpost) + (kG6 * R1_G_GTP) - (kRK1_1 * RK * R1 - kRK2 * R1_RKpre) - (kA1_1 * Arr * R1 - kA2 * R1_Arr) - (ktherm * R1) - (kG1_1 * Gt * R1 - kG2 * R1_Gt);
    der(R1_Arr) = (kA1_1 * Arr * R1 - kA2 * R1_Arr) - (kA3 * R1_Arr);
    der(R1_G) = (kG3 * R1_Gt - kG4_GDP * R1_G) - (kG5_GTP * R1_G);
    der(R1_G_GTP) = (kG5_GTP * R1_G) - (kG6 * R1_G_GTP);
    der(R1_Gt) = (kG1_1 * Gt * R1 - kG2 * R1_Gt) - (kG3 * R1_Gt - kG4_GDP * R1_G);
    der(R1_RKpost) = (kRK3_ATP * R0_RKpre) - (kRK4 * R1_RKpost);
    der(R1_RKpre) = (kRK1_1 * RK * R1 - kRK2 * R1_RKpre) - (kRK3_ATP * R1_RKpre);
    der(R2) = (kRK4 * R2_RKpost) + (kG6 * R2_G_GTP) - (kRK1_2 * RK * R2 - kRK2 * R2_RKpre) - (kA1_2 * Arr * R2 - kA2 * R2_Arr) - (ktherm * R2) - (kG1_2 * Gt * R2 - kG2 * R2_Gt);
    der(R2_Arr) = (kA1_2 * Arr * R2 - kA2 * R2_Arr) - (kA3 * R2_Arr);
    der(R2_G) = (kG3 * R2_Gt - kG4_GDP * R2_G) - (kG5_GTP * R2_G);
    der(R2_G_GTP) = (kG5_GTP * R2_G) - (kG6 * R2_G_GTP);
    der(R2_Gt) = (kG1_2 * Gt * R2 - kG2 * R2_Gt) - (kG3 * R2_Gt - kG4_GDP * R2_G);
    der(R2_RKpost) = (kRK3_ATP * R1_RKpre) - (kRK4 * R2_RKpost);
    der(R2_RKpre) = (kRK1_2 * RK * R2 - kRK2 * R2_RKpre) - (kRK3_ATP * R2_RKpre);
    der(R3) = (kRK4 * R3_RKpost) + (kG6 * R3_G_GTP) - (kRK1_3 * RK * R3 - kRK2 * R3_RKpre) - (kA1_3 * Arr * R3 - kA2 * R3_Arr) - (ktherm * R3) - (kG1_3 * Gt * R3 - kG2 * R3_Gt);
    der(R3_Arr) = (kA1_3 * Arr * R3 - kA2 * R3_Arr) - (kA3 * R3_Arr);
    der(R3_G) = (kG3 * R3_Gt - kG4_GDP * R3_G) - (kG5_GTP * R3_G);
    der(R3_G_GTP) = (kG5_GTP * R3_G) - (kG6 * R3_G_GTP);
    der(R3_Gt) = (kG1_3 * Gt * R3 - kG2 * R3_Gt) - (kG3 * R3_Gt - kG4_GDP * R3_G);
    der(R3_RKpost) = (kRK3_ATP * R2_RKpre) - (kRK4 * R3_RKpost);
    der(R3_RKpre) = (kRK1_3 * RK * R3 - kRK2 * R3_RKpre) - (kRK3_ATP * R3_RKpre);
    der(R4) = (kRK4 * R4_RKpost) + (kG6 * R4_G_GTP) - (kRK1_4 * RK * R4 - kRK2 * R4_RKpre) - (kA1_4 * Arr * R4 - kA2 * R4_Arr) - (ktherm * R4) - (kG1_4 * Gt * R4 - kG2 * R4_Gt);
    der(R4_Arr) = (kA1_4 * Arr * R4 - kA2 * R4_Arr) - (kA3 * R4_Arr);
    der(R4_G) = (kG3 * R4_Gt - kG4_GDP * R4_G) - (kG5_GTP * R4_G);
    der(R4_G_GTP) = (kG5_GTP * R4_G) - (kG6 * R4_G_GTP);
    der(R4_Gt) = (kG1_4 * Gt * R4 - kG2 * R4_Gt) - (kG3 * R4_Gt - kG4_GDP * R4_G);
    der(R4_RKpost) = (kRK3_ATP * R3_RKpre) - (kRK4 * R4_RKpost);
    der(R4_RKpre) = (kRK1_4 * RK * R4 - kRK2 * R4_RKpre) - (kRK3_ATP * R4_RKpre);
    der(R5) = (kRK4 * R5_RKpost) + (kG6 * R5_G_GTP) - (kRK1_5 * RK * R5 - kRK2 * R5_RKpre) - (kA1_5 * Arr * R5 - kA2 * R5_Arr) - (ktherm * R5) - (kG1_5 * Gt * R5 - kG2 * R5_Gt);
    der(R5_Arr) = (kA1_5 * Arr * R5 - kA2 * R5_Arr) - (kA3 * R5_Arr);
    der(R5_G) = (kG3 * R5_Gt - kG4_GDP * R5_G) - (kG5_GTP * R5_G);
    der(R5_G_GTP) = (kG5_GTP * R5_G) - (kG6 * R5_G_GTP);
    der(R5_Gt) = (kG1_5 * Gt * R5 - kG2 * R5_Gt) - (kG3 * R5_Gt - kG4_GDP * R5_G);
    der(R5_RKpost) = (kRK3_ATP * R4_RKpre) - (kRK4 * R5_RKpost);
    der(R5_RKpre) = (kRK1_5 * RK * R5 - kRK2 * R5_RKpre) - (kRK3_ATP * R5_RKpre);
    der(R6) = (kRK4 * R6_RKpost) + (kG6 * R6_G_GTP) - (kRK1_6 * RK * R6 - kRK2 * R6_RKpre) - (kA1_6 * Arr * R6 - kA2 * R6_Arr) - (ktherm * R6) - (kG1_6 * Gt * R6 - kG2 * R6_Gt);
    der(R6_Arr) = (kA1_6 * Arr * R6 - kA2 * R6_Arr) - (kA3 * R6_Arr);
    der(R6_G) = (kG3 * R6_Gt - kG4_GDP * R6_G) - (kG5_GTP * R6_G);
    der(R6_G_GTP) = (kG5_GTP * R6_G) - (kG6 * R6_G_GTP);
    der(R6_Gt) = (kG1_6 * Gt * R6 - kG2 * R6_Gt) - (kG3 * R6_Gt - kG4_GDP * R6_G);
    der(R6_RKpost) = (kRK3_ATP * R5_RKpre) - (kRK4 * R6_RKpost);
    der(R6_RKpre) = (kRK1_6 * RK * R6 - kRK2 * R6_RKpre) ;
    der(RGS) = (kRGS2 * RGS_Ga_GTP_a_PDE_a_Ga_GTP) + (kRGS2 * RGS_PDE_a_Ga_GTP) - (kRGS1 * RGS * Ga_GTP_a_PDE_a_Ga_GTP) - (kRGS1 * RGS * PDE_a_Ga_GTP);
    der(RGS_Ga_GTP_a_PDE_a_Ga_GTP) = (kRGS1 * RGS * Ga_GTP_a_PDE_a_Ga_GTP) - (kRGS2 * RGS_Ga_GTP_a_PDE_a_Ga_GTP);
    der(RGS_PDE_a_Ga_GTP) = (kRGS1 * RGS * PDE_a_Ga_GTP) - (kRGS2 * RGS_PDE_a_Ga_GTP);
    der(RK) = (kRK4 * R1_RKpost) + (kRK4 * R2_RKpost) + (kRK4 * R3_RKpost) + (kRK4 * R4_RKpost) + (kRK4 * R5_RKpost) + (kRK4 * R6_RKpost) - (kRK1_0 * RK * R0 - kRK2 * R0_RKpre) - (kRK1_1 * RK * R1 - kRK2 * R1_RKpre) - (kRK1_2 * RK * R2 - kRK2 * R2_RKpre) - (kRK1_3 * RK * R3 - kRK2 * R3_RKpre) - (kRK1_4 * RK * R4 - kRK2 * R4_RKpre) - (kRK1_5 * RK * R5 - kRK2 * R5_RKpre) - (kRK1_6 * RK * R6 - kRK2 * R6_RKpre) - (kRec3 * RecR_Ca * RK - kRec4 * RecR_Ca_RK);
    der(R_Gt) = (kGpre1 * Gt * R - kGpre2 * R_Gt) - (stimulus * R_Gt / Rtot);
    der(RecR_Ca) = (kRec1 * RecT * Ca2_free - kRec2 * RecR_Ca) - (kRec3 * RecR_Ca * RK - kRec4 * RecR_Ca_RK);
    der(RecR_Ca_RK) = (kRec3 * RecR_Ca * RK - kRec4 * RecR_Ca_RK) ;
    der(RecT) =  - (kRec1 * RecT * Ca2_free - kRec2 * RecR_Ca);
    der(cGMP) = (alfamax / (1 + pow(Ca2_free / Kc1, m1)) + alfamax / (1 + pow(Ca2_free / Kc2, m2))) - ((betadark + betasub * E) * cGMP);




end BIOMD578;
