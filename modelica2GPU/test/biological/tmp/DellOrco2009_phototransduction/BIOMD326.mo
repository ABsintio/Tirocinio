
model BIOMD326 "DellOrco2009_phototransduction"

    function pow
        input  Real x;
        input  Real power;
        output Real y;
        algorithm
            y := x^power;
    end pow;



    parameter Real Rtot = 3600000000.0;
    parameter Real PDEtot = 13350000.0;
    parameter Real Gtot = 360000000.0;
    parameter Real Rectot = 35.0;
    parameter Real RGStot = 3000000.0;
    parameter Real ArrTot = 31300000.0;
    parameter Real flashBG = 0.0;
    parameter Real flash0Dur = 0.001;
    parameter Real flash0Mag = 0.0;
    parameter Real flashDel = 0.0;
    parameter Real flashDur = 0.001;
    parameter Real flashMag = 0.0;
    parameter Real otherstimulus = 0.0;
    parameter Real kRK1_0 = 0.0076429599557114;
    parameter Real omega = 0.6;
    parameter Real kRK2 = 250.0;
    parameter Real RKdark = 10838.0;
    parameter Real kRK3_ATP = 400.0;
    parameter Real kRK4 = 20.0;
    parameter Real omega_arr = 0.81323;
    parameter Real kArr = 6.0918e-10;
    parameter Real kA2 = 0.00323198;
    parameter Real kA3 = 0.0445091;
    parameter Real kOps = 6.1172e-13;
    parameter Real kRrecyc = 0.0007;
    parameter Real kG1_0 = 3.0586111111e-05;
    parameter Real kG2 = 2250.34;
    parameter Real kG3 = 2000.0;
    parameter Real kG4_GDP = 600.0;
    parameter Real kG5_GTP = 750.0;
    parameter Real kG6 = 2000.0;
    parameter Real kG7 = 200.0;
    parameter Real kGrecyc = 2.0;
    parameter Real kGshutoff = 0.05;
    parameter Real kP1 = 0.0549715;
    parameter Real kP1_rev = 0.0;
    parameter Real kP2 = 940.706;
    parameter Real kP3 = 1.49834e-09;
    parameter Real kP4 = 21.0881;
    parameter Real kPDEshutoff = 0.033;
    parameter Real kRGS1 = 1.57e-07;
    parameter Real kRGS2 = 256.07;
    parameter Real kRec3 = 9.68777;
    parameter Real kRec4 = 0.610084;
    parameter Real Kp = 0.425272;
    parameter Real w = 2.0;
    parameter Real Vcyto = 1.0;
    parameter Real Kc = 0.17;
    parameter Real m = 2.5;
    parameter Real betadark = 1.2;
    parameter Real betasub = 0.00043;
    parameter Real fCa = 0.2;
    parameter Real Jdark = 29.7778;
    parameter Real F = 96485.3415;
    parameter Real cGMPdark = 4.0;
    parameter Real ncg = 3.0;
    parameter Real gammaCa = 47.554;
    parameter Real Ca2dark = 0.6;
    parameter Real Ca2_0 = 0.01;
    parameter Real k1 = 0.381529;
    parameter Real k2 = 1.9094;
    parameter Real eT = 400.0;
    parameter Real ktherm = 0.0238;
    parameter Real cytosol = 1.0;

    Real background(start=0.0);
    Real premag(start=0.0);
    Real mag(start=0.0);
    Real predur(start=0.0);
    Real dur(start=0.0);
    Real del(start=0.0);
    Real preflash(start=0.0);
    Real testflash(start=0.0);
    Real stimulus(start=0.0);
    Real numConcFactor(start=0.0);
    Real kRK1_1(start=0.0);
    Real kRK1_2(start=0.0);
    Real kRK1_3(start=0.0);
    Real kRK1_4(start=0.0);
    Real kRK1_5(start=0.0);
    Real kRK1_6(start=0.0);
    Real kA1_1(start=0.0);
    Real kA1_2(start=0.0);
    Real kA1_3(start=0.0);
    Real kA1_4(start=0.0);
    Real kA1_5(start=0.0);
    Real kA1_6(start=0.0);
    Real kG1_1(start=0.0);
    Real kG1_2(start=0.0);
    Real kG1_3(start=0.0);
    Real kG1_4(start=0.0);
    Real kG1_5(start=0.0);
    Real kG1_6(start=0.0);
    Real E(start=0.0);
    Real Rec_wCa2(start=0.0);
    Real alfamax(start=0.0);
    Real J(start=0.0);
    Real deltaJ(start=0.0);

    Real Arr;
    Real Ca2_buff;
    Real Ca2_free;
    Real G_GTP;
    Real Ga_GDP;
    Real Ga_GTP;
    Real Ga_GTP_PDE_a_Ga_GTP;
    Real Ga_GTP_a_PDE_a_Ga_GTP;
    Real Gbg;
    Real Gt;
    Real Ops;
    Real Ops_G;
    Real Ops_G_GTP;
    Real Ops_Gt;
    Real PDE;
    Real PDE_Ga_GTP;
    Real PDE_a_Ga_GTP;
    Real R;
    Real R0;
    Real R0_G;
    Real R0_G_GTP;
    Real R0_Gt;
    Real R0_RKpre;
    Real R1;
    Real R1_Arr;
    Real R1_G;
    Real R1_G_GTP;
    Real R1_Gt;
    Real R1_RKpost;
    Real R1_RKpre;
    Real R2;
    Real R2_Arr;
    Real R2_G;
    Real R2_G_GTP;
    Real R2_Gt;
    Real R2_RKpost;
    Real R2_RKpre;
    Real R3;
    Real R3_Arr;
    Real R3_G;
    Real R3_G_GTP;
    Real R3_Gt;
    Real R3_RKpost;
    Real R3_RKpre;
    Real R4;
    Real R4_Arr;
    Real R4_G;
    Real R4_G_GTP;
    Real R4_Gt;
    Real R4_RKpost;
    Real R4_RKpre;
    Real R5;
    Real R5_Arr;
    Real R5_G;
    Real R5_G_GTP;
    Real R5_Gt;
    Real R5_RKpost;
    Real R5_RKpre;
    Real R6;
    Real R6_Arr;
    Real R6_G;
    Real R6_G_GTP;
    Real R6_Gt;
    Real R6_RKpost;
    Real R6_RKpre;
    Real RGS;
    Real RGS_Ga_GTP_a_PDE_a_Ga_GTP;
    Real RGS_PDE_a_Ga_GTP;
    Real RK;
    Real Rec_wCa2_RK;
    Real cGMP;

initial equation
    Arr = 31300000.0;
    Ca2_buff = 42.857;
    Ca2_free = 0.6;
    G_GTP = 0.0;
    Ga_GDP = 0.0;
    Ga_GTP = 0.0;
    Ga_GTP_PDE_a_Ga_GTP = 0.0;
    Ga_GTP_a_PDE_a_Ga_GTP = 0.0;
    Gbg = 0.0;
    Gt = 360000000.0;
    Ops = 0.0;
    Ops_G = 0.0;
    Ops_G_GTP = 0.0;
    Ops_Gt = 0.0;
    PDE = 13350000.0;
    PDE_Ga_GTP = 0.0;
    PDE_a_Ga_GTP = 0.0;
    R = 3600000000.0;
    R0 = 0.0;
    R0_G = 0.0;
    R0_G_GTP = 0.0;
    R0_Gt = 0.0;
    R0_RKpre = 0.0;
    R1 = 0.0;
    R1_Arr = 0.0;
    R1_G = 0.0;
    R1_G_GTP = 0.0;
    R1_Gt = 0.0;
    R1_RKpost = 0.0;
    R1_RKpre = 0.0;
    R2 = 0.0;
    R2_Arr = 0.0;
    R2_G = 0.0;
    R2_G_GTP = 0.0;
    R2_Gt = 0.0;
    R2_RKpost = 0.0;
    R2_RKpre = 0.0;
    R3 = 0.0;
    R3_Arr = 0.0;
    R3_G = 0.0;
    R3_G_GTP = 0.0;
    R3_Gt = 0.0;
    R3_RKpost = 0.0;
    R3_RKpre = 0.0;
    R4 = 0.0;
    R4_Arr = 0.0;
    R4_G = 0.0;
    R4_G_GTP = 0.0;
    R4_Gt = 0.0;
    R4_RKpost = 0.0;
    R4_RKpre = 0.0;
    R5 = 0.0;
    R5_Arr = 0.0;
    R5_G = 0.0;
    R5_G_GTP = 0.0;
    R5_Gt = 0.0;
    R5_RKpost = 0.0;
    R5_RKpre = 0.0;
    R6 = 0.0;
    R6_Arr = 0.0;
    R6_G = 0.0;
    R6_G_GTP = 0.0;
    R6_Gt = 0.0;
    R6_RKpost = 0.0;
    R6_RKpre = 0.0;
    RGS = 3000000.0;
    RGS_Ga_GTP_a_PDE_a_Ga_GTP = 0.0;
    RGS_PDE_a_Ga_GTP = 0.0;
    RK = 10838.0;
    Rec_wCa2_RK = 4204560.0;
    cGMP = 4.0;

equation
    background = flashBG;
    premag = flash0Mag / flash0Dur;
    mag = flashMag / flashDur;
    predur = flash0Dur;
    dur = flashDur;
    del = flashDel;
    preflash = piecewise(premag, leq(time, predur), 0);
    testflash = piecewise(mag, and(geq(time, del), leq(time, del + dur)), 0);
    stimulus = background + preflash + testflash + otherstimulus;
    numConcFactor = 1 / (6.022e5 * Vcyto);
    kRK1_1 = kRK1_0 * exp(-omega);
    kRK1_2 = kRK1_0 * exp(-omega * 2);
    kRK1_3 = kRK1_0 * exp(-omega * 3);
    kRK1_4 = kRK1_0 * exp(-omega * 4);
    kRK1_5 = kRK1_0 * exp(-omega * 5);
    kRK1_6 = 0;
    kA1_1 = kArr * exp(omega_arr);
    kA1_2 = kArr * exp(omega_arr * 2);
    kA1_3 = kArr * exp(omega_arr * 3);
    kA1_4 = kArr * exp(omega_arr * 4);
    kA1_5 = kArr * exp(omega_arr * 5);
    kA1_6 = kArr * exp(omega_arr * 6);
    kG1_1 = kG1_0 * exp(-omega);
    kG1_2 = kG1_0 * exp(-omega * 2);
    kG1_3 = kG1_0 * exp(-omega * 3);
    kG1_4 = kG1_0 * exp(-omega * 4);
    kG1_5 = kG1_0 * exp(-omega * 5);
    kG1_6 = kG1_0 * exp(-omega * 6);
    E = PDE_a_Ga_GTP + 2 * Ga_GTP_a_PDE_a_Ga_GTP;
    Rec_wCa2 = (Rectot - Rec_wCa2_RK * numConcFactor) / (1 + pow(Kp / Ca2_free, w));
    alfamax = betadark * cGMPdark * (1 + pow(Ca2dark / Kc, m));
    J = 2 / (2 + fCa) * pow(cGMP / cGMPdark, ncg) * Jdark + fCa / (fCa + 2) * (Ca2_free - Ca2_0) / (Ca2dark - Ca2_0) * Jdark;
    deltaJ = Jdark - J;
    der(Arr) = (kA3 * R1_Arr) + (kA3 * R2_Arr) + (kA3 * R3_Arr) + (kA3 * R4_Arr) + (kA3 * R5_Arr) + (kA3 * R6_Arr) - (kA1_1 * Arr * R1 - kA2 * R1_Arr) - (kA1_2 * Arr * R2 - kA2 * R2_Arr) - (kA1_3 * Arr * R3 - kA2 * R3_Arr) - (kA1_4 * Arr * R4 - kA2 * R4_Arr) - (kA1_5 * Arr * R5 - kA2 * R5_Arr) - (kA1_6 * Arr * R6 - kA2 * R6_Arr);
    der(Ca2_buff) = (k1 * (eT - Ca2_buff) * Ca2_free - k2 * Ca2_buff) ;
    der(Ca2_free) = ((1e6 * fCa * Jdark / ((2 + fCa) * F * Vcyto)) * (cGMP / cGMPdark)^ncg) - (k1 * (eT - Ca2_buff) * Ca2_free - k2 * Ca2_buff) - (gammaCa * (Ca2_free - Ca2_0));
    der(G_GTP) = (kG6 * Ops_G_GTP) + (kG6 * R0_G_GTP) + (kG6 * R1_G_GTP) + (kG6 * R2_G_GTP) + (kG6 * R3_G_GTP) + (kG6 * R4_G_GTP) + (kG6 * R5_G_GTP) + (kG6 * R6_G_GTP) - (kG7 * G_GTP);
    der(Ga_GDP) = (kRGS2 * RGS_Ga_GTP_a_PDE_a_Ga_GTP) + (kRGS2 * RGS_PDE_a_Ga_GTP) + (kPDEshutoff * PDE_a_Ga_GTP) + (kPDEshutoff * Ga_GTP_a_PDE_a_Ga_GTP) + (kGshutoff * Ga_GTP) - (kGrecyc * Gbg * Ga_GDP);
    der(Ga_GTP) = (kG7 * G_GTP) - (kP1 * PDE * Ga_GTP - kP1_rev * PDE_Ga_GTP) - (kP3 * PDE_a_Ga_GTP * Ga_GTP) - (kGshutoff * Ga_GTP);
    der(Ga_GTP_PDE_a_Ga_GTP) = (kP3 * PDE_a_Ga_GTP * Ga_GTP) - (kP4 * Ga_GTP_PDE_a_Ga_GTP);
    der(Ga_GTP_a_PDE_a_Ga_GTP) = (kP4 * Ga_GTP_PDE_a_Ga_GTP) - (kRGS1 * RGS * Ga_GTP_a_PDE_a_Ga_GTP) - (kPDEshutoff * Ga_GTP_a_PDE_a_Ga_GTP);
    der(Gbg) = (kG7 * G_GTP) - (kGrecyc * Gbg * Ga_GDP);
    der(Gt) = (kGrecyc * Gbg * Ga_GDP) - (kOps * Ops * Gt - kG2 * Ops_Gt) - (kG1_0 * Gt * R0 - kG2 * R0_Gt) - (kG1_1 * Gt * R1 - kG2 * R1_Gt) - (kG1_2 * Gt * R2 - kG2 * R2_Gt) - (kG1_3 * Gt * R3 - kG2 * R3_Gt) - (kG1_4 * Gt * R4 - kG2 * R4_Gt) - (kG1_5 * Gt * R5 - kG2 * R5_Gt) - (kG1_6 * Gt * R6 - kG2 * R6_Gt);
    der(Ops) = (kA3 * R1_Arr) + (kA3 * R2_Arr) + (kA3 * R3_Arr) + (kA3 * R4_Arr) + (kA3 * R5_Arr) + (kA3 * R6_Arr) + (ktherm * R0) + (ktherm * R1) + (ktherm * R2) + (ktherm * R3) + (ktherm * R4) + (ktherm * R5) + (ktherm * R6) + (kG6 * Ops_G_GTP) - (kOps * Ops * Gt - kG2 * Ops_Gt) - (kRrecyc * Ops);
    der(Ops_G) = (kG3 * Ops_Gt - kG4_GDP * Ops_G) - (kG5_GTP * Ops_G);
    der(Ops_G_GTP) = (kG5_GTP * Ops_G) - (kG6 * Ops_G_GTP);
    der(Ops_Gt) = (kOps * Ops * Gt - kG2 * Ops_Gt) - (kG3 * Ops_Gt - kG4_GDP * Ops_G);
    der(PDE) = (kRGS2 * RGS_PDE_a_Ga_GTP) + (kPDEshutoff * PDE_a_Ga_GTP) - (kP1 * PDE * Ga_GTP - kP1_rev * PDE_Ga_GTP);
    der(PDE_Ga_GTP) = (kP1 * PDE * Ga_GTP - kP1_rev * PDE_Ga_GTP) - (kP2 * PDE_Ga_GTP);
    der(PDE_a_Ga_GTP) = (kP2 * PDE_Ga_GTP) + (kRGS2 * RGS_Ga_GTP_a_PDE_a_Ga_GTP) + (kPDEshutoff * Ga_GTP_a_PDE_a_Ga_GTP) - (kP3 * PDE_a_Ga_GTP * Ga_GTP) - (kRGS1 * RGS * PDE_a_Ga_GTP) - (kPDEshutoff * PDE_a_Ga_GTP);
    der(R) = (kRrecyc * Ops) - (stimulus * R / Rtot);
    der(R0) = (stimulus * R / Rtot) + (kG6 * R0_G_GTP) - (kRK1_0 * RK * R0 - kRK2 * R0_RKpre) - (ktherm * R0) - (kG1_0 * Gt * R0 - kG2 * R0_Gt);
    der(R0_G) = (kG3 * R0_Gt - kG4_GDP * R0_G) - (kG5_GTP * R0_G);
    der(R0_G_GTP) = (kG5_GTP * R0_G) - (kG6 * R0_G_GTP);
    der(R0_Gt) = (kG1_0 * Gt * R0 - kG2 * R0_Gt) - (kG3 * R0_Gt - kG4_GDP * R0_G);
    der(R0_RKpre) = (kRK1_0 * RK * R0 - kRK2 * R0_RKpre) - (kRK3_ATP * R0_RKpre);
    der(R1) = (kRK4 * R1_RKpost) + (kG6 * R1_G_GTP) - (kRK1_1 * RK * R1 - kRK2 * R1_RKpre) - (kA1_1 * Arr * R1 - kA2 * R1_Arr) - (ktherm * R1) - (kG1_1 * Gt * R1 - kG2 * R1_Gt);
    der(R1_Arr) = (kA1_1 * Arr * R1 - kA2 * R1_Arr) - (kA3 * R1_Arr);
    der(R1_G) = (kG3 * R1_Gt - kG4_GDP * R1_G) - (kG5_GTP * R1_G);
    der(R1_G_GTP) = (kG5_GTP * R1_G) - (kG6 * R1_G_GTP);
    der(R1_Gt) = (kG1_1 * Gt * R1 - kG2 * R1_Gt) - (kG3 * R1_Gt - kG4_GDP * R1_G);
    der(R1_RKpost) = (kRK3_ATP * R0_RKpre) - (kRK4 * R1_RKpost);
    der(R1_RKpre) = (kRK1_1 * RK * R1 - kRK2 * R1_RKpre) - (kRK3_ATP * R1_RKpre);
    der(R2) = (kRK4 * R2_RKpost) + (kG6 * R2_G_GTP) - (kRK1_2 * RK * R2 - kRK2 * R2_RKpre) - (kA1_2 * Arr * R2 - kA2 * R2_Arr) - (ktherm * R2) - (kG1_2 * Gt * R2 - kG2 * R2_Gt);
    der(R2_Arr) = (kA1_2 * Arr * R2 - kA2 * R2_Arr) - (kA3 * R2_Arr);
    der(R2_G) = (kG3 * R2_Gt - kG4_GDP * R2_G) - (kG5_GTP * R2_G);
    der(R2_G_GTP) = (kG5_GTP * R2_G) - (kG6 * R2_G_GTP);
    der(R2_Gt) = (kG1_2 * Gt * R2 - kG2 * R2_Gt) - (kG3 * R2_Gt - kG4_GDP * R2_G);
    der(R2_RKpost) = (kRK3_ATP * R1_RKpre) - (kRK4 * R2_RKpost);
    der(R2_RKpre) = (kRK1_2 * RK * R2 - kRK2 * R2_RKpre) - (kRK3_ATP * R2_RKpre);
    der(R3) = (kRK4 * R3_RKpost) + (kG6 * R3_G_GTP) - (kRK1_3 * RK * R3 - kRK2 * R3_RKpre) - (kA1_3 * Arr * R3 - kA2 * R3_Arr) - (ktherm * R3) - (kG1_3 * Gt * R3 - kG2 * R3_Gt);
    der(R3_Arr) = (kA1_3 * Arr * R3 - kA2 * R3_Arr) - (kA3 * R3_Arr);
    der(R3_G) = (kG3 * R3_Gt - kG4_GDP * R3_G) - (kG5_GTP * R3_G);
    der(R3_G_GTP) = (kG5_GTP * R3_G) - (kG6 * R3_G_GTP);
    der(R3_Gt) = (kG1_3 * Gt * R3 - kG2 * R3_Gt) - (kG3 * R3_Gt - kG4_GDP * R3_G);
    der(R3_RKpost) = (kRK3_ATP * R2_RKpre) - (kRK4 * R3_RKpost);
    der(R3_RKpre) = (kRK1_3 * RK * R3 - kRK2 * R3_RKpre) - (kRK3_ATP * R3_RKpre);
    der(R4) = (kRK4 * R4_RKpost) + (kG6 * R4_G_GTP) - (kRK1_4 * RK * R4 - kRK2 * R4_RKpre) - (kA1_4 * Arr * R4 - kA2 * R4_Arr) - (ktherm * R4) - (kG1_4 * Gt * R4 - kG2 * R4_Gt);
    der(R4_Arr) = (kA1_4 * Arr * R4 - kA2 * R4_Arr) - (kA3 * R4_Arr);
    der(R4_G) = (kG3 * R4_Gt - kG4_GDP * R4_G) - (kG5_GTP * R4_G);
    der(R4_G_GTP) = (kG5_GTP * R4_G) - (kG6 * R4_G_GTP);
    der(R4_Gt) = (kG1_4 * Gt * R4 - kG2 * R4_Gt) - (kG3 * R4_Gt - kG4_GDP * R4_G);
    der(R4_RKpost) = (kRK3_ATP * R3_RKpre) - (kRK4 * R4_RKpost);
    der(R4_RKpre) = (kRK1_4 * RK * R4 - kRK2 * R4_RKpre) - (kRK3_ATP * R4_RKpre);
    der(R5) = (kRK4 * R5_RKpost) + (kG6 * R5_G_GTP) - (kRK1_5 * RK * R5 - kRK2 * R5_RKpre) - (kA1_5 * Arr * R5 - kA2 * R5_Arr) - (ktherm * R5) - (kG1_5 * Gt * R5 - kG2 * R5_Gt);
    der(R5_Arr) = (kA1_5 * Arr * R5 - kA2 * R5_Arr) - (kA3 * R5_Arr);
    der(R5_G) = (kG3 * R5_Gt - kG4_GDP * R5_G) - (kG5_GTP * R5_G);
    der(R5_G_GTP) = (kG5_GTP * R5_G) - (kG6 * R5_G_GTP);
    der(R5_Gt) = (kG1_5 * Gt * R5 - kG2 * R5_Gt) - (kG3 * R5_Gt - kG4_GDP * R5_G);
    der(R5_RKpost) = (kRK3_ATP * R4_RKpre) - (kRK4 * R5_RKpost);
    der(R5_RKpre) = (kRK1_5 * RK * R5 - kRK2 * R5_RKpre) - (kRK3_ATP * R5_RKpre);
    der(R6) = (kRK4 * R6_RKpost) + (kG6 * R6_G_GTP) - (kRK1_6 * RK * R6 - kRK2 * R6_RKpre) - (kA1_6 * Arr * R6 - kA2 * R6_Arr) - (ktherm * R6) - (kG1_6 * Gt * R6 - kG2 * R6_Gt);
    der(R6_Arr) = (kA1_6 * Arr * R6 - kA2 * R6_Arr) - (kA3 * R6_Arr);
    der(R6_G) = (kG3 * R6_Gt - kG4_GDP * R6_G) - (kG5_GTP * R6_G);
    der(R6_G_GTP) = (kG5_GTP * R6_G) - (kG6 * R6_G_GTP);
    der(R6_Gt) = (kG1_6 * Gt * R6 - kG2 * R6_Gt) - (kG3 * R6_Gt - kG4_GDP * R6_G);
    der(R6_RKpost) = (kRK3_ATP * R5_RKpre) - (kRK4 * R6_RKpost);
    der(R6_RKpre) = (kRK1_6 * RK * R6 - kRK2 * R6_RKpre) ;
    der(RGS) = (kRGS2 * RGS_Ga_GTP_a_PDE_a_Ga_GTP) + (kRGS2 * RGS_PDE_a_Ga_GTP) - (kRGS1 * RGS * Ga_GTP_a_PDE_a_Ga_GTP) - (kRGS1 * RGS * PDE_a_Ga_GTP);
    der(RGS_Ga_GTP_a_PDE_a_Ga_GTP) = (kRGS1 * RGS * Ga_GTP_a_PDE_a_Ga_GTP) - (kRGS2 * RGS_Ga_GTP_a_PDE_a_Ga_GTP);
    der(RGS_PDE_a_Ga_GTP) = (kRGS1 * RGS * PDE_a_Ga_GTP) - (kRGS2 * RGS_PDE_a_Ga_GTP);
    der(RK) = (kRK4 * R1_RKpost) + (kRK4 * R2_RKpost) + (kRK4 * R3_RKpost) + (kRK4 * R4_RKpost) + (kRK4 * R5_RKpost) + (kRK4 * R6_RKpost) - (kRK1_0 * RK * R0 - kRK2 * R0_RKpre) - (kRK1_1 * RK * R1 - kRK2 * R1_RKpre) - (kRK1_2 * RK * R2 - kRK2 * R2_RKpre) - (kRK1_3 * RK * R3 - kRK2 * R3_RKpre) - (kRK1_4 * RK * R4 - kRK2 * R4_RKpre) - (kRK1_5 * RK * R5 - kRK2 * R5_RKpre) - (kRK1_6 * RK * R6 - kRK2 * R6_RKpre) - (kRec3 * Rec_wCa2 * RK - kRec4 * Rec_wCa2_RK);
    der(Rec_wCa2_RK) = (kRec3 * Rec_wCa2 * RK - kRec4 * Rec_wCa2_RK) ;
    der(cGMP) = (alfamax / (1 + (Ca2_free / Kc)^m)) - ((betadark + betasub * E) * cGMP);




end BIOMD326;
