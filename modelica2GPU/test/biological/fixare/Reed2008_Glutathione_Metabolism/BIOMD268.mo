
model BIOMD268 "Reed2008_Glutathione_Metabolism"

    function pow
        input  Real x;
        input  Real power;
        output Real y;
        algorithm
            y := x^power;
    end pow;


    function MM
        	input Real Vmax;
	input Real Km;
	input Real S;
        output Real y;
    algorithm
        y :=  Vmax * S / (Km + S);
    end MM;


    function MM_twosubst
        	input Real Vmax;
	input Real Km1;
	input Real Km2;
	input Real S1;
	input Real S2;
        output Real y;
    algorithm
        y :=  Vmax * S1 * S2 / ((Km1 + S1) * (Km2 + S2));
    end MM_twosubst;


    parameter Real V_gshHb = 150.0;
    parameter Real K_gshHb = 150.0;
    parameter Real V_gshLb = 1100.0;
    parameter Real h_gshLb = 3.0;
    parameter Real K_gshLb = 3000.0;
    parameter Real V_gsgHb = 40.0;
    parameter Real K_gsgHb = 1250.0;
    parameter Real V_gsgLb = 4025.0;
    parameter Real K_gsgLb = 7100.0;
    parameter Real V_bcysc = 14950.0;
    parameter Real K_bcysc = 2100.0;
    parameter Real V_bglutc = 28000.0;
    parameter Real K_bglutc = 300.0;
    parameter Real k_out_glu = 1.0;
    parameter Real V_bglyc = 4600.0;
    parameter Real K_bglyc = 150.0;
    parameter Real k_out_gly = 1.0;
    parameter Real V_bserc = 2700.0;
    parameter Real K_bserc = 150.0;
    parameter Real k_out_ser = 1.0;
    parameter Real V_bmetc = 913.4;
    parameter Real K_bmetc = 150.0;
    parameter Real k_out_met = 1.0;
    parameter Real Vm_mFTD = 1050.0;
    parameter Real K_10f_FTD = 20.0;
    parameter Real Vf_mSHMT = 11440.0;
    parameter Real K_thf_SHMT = 50.0;
    parameter Real K_ser_SHMT = 600.0;
    parameter Real Vr_mSHMT = 30000000.0;
    parameter Real K_gly_SHMT = 10000.0;
    parameter Real K_2cf_SHMT = 3200.0;
    parameter Real Vf_mFTS = 2000.0;
    parameter Real K_thf_mFTS = 3.0;
    parameter Real K_coo_mFTS = 43.0;
    parameter Real Vr_mFTS = 6300.0;
    parameter Real K_10f_mFTS = 22.0;
    parameter Real k1_mNE = 0.03;
    parameter Real k2_mNE = 20.0;
    parameter Real Vm_GDC = 15000.0;
    parameter Real K_thf_GDC = 50.0;
    parameter Real K_gly_GDC = 3400.0;
    parameter Real Vm_SDH = 15000.0;
    parameter Real K_thf_SDH = 50.0;
    parameter Real K_src_SDH = 320.0;
    parameter Real Vm_DMGD = 15000.0;
    parameter Real K_thf_DMGD = 50.0;
    parameter Real K_dmg_DMGD = 50.0;
    parameter Real Vf_mMTD = 180000.0;
    parameter Real K_2cf_MTD = 2.0;
    parameter Real Vr_MTD = 594000.0;
    parameter Real K_1cf_MTD = 10.0;
    parameter Real Vf_mMTCH = 790000.0;
    parameter Real K_1cf_MTCH = 250.0;
    parameter Real Vr_MTCH = 20000.0;
    parameter Real K_10f_MTCH = 100.0;
    parameter Real V_mser = 10000.0;
    parameter Real K_mser = 5700.0;
    parameter Real V_cser = 10000.0;
    parameter Real K_cser = 5700.0;
    parameter Real k_in_coo = 100.0;
    parameter Real k_out_coo = 100.0;
    parameter Real V_mgly = 10000.0;
    parameter Real K_mgly = 5700.0;
    parameter Real V_cgly = 10000.0;
    parameter Real K_cgly = 5700.0;
    parameter Real Vm_MS = 500.0;
    parameter Real K_5mf_MS = 25.0;
    parameter Real K_hcy_MS = 1.0;
    parameter Real ssH2O2 = 0.01;
    parameter Real Ki_MS = 0.01;
    parameter Real Vm_DHFR = 2000.0;
    parameter Real K_dhf_DHFR = 0.5;
    parameter Real K_NADPH_DHFR = 4.0;
    parameter Real Vm_cFTD = 500.0;
    parameter Real Vm_PGT = 24300.0;
    parameter Real K_10f_PGT = 4.9;
    parameter Real K_GAR_PGT = 520.0;
    parameter Real Vm_cFTS = 3900.0;
    parameter Real K_thf_cFTS = 3.0;
    parameter Real K_coo_cFTS = 43.0;
    parameter Real Vf_cSHMT = 5200.0;
    parameter Real Vr_cSHMT = 15000000.0;
    parameter Real k1_cNE = 0.03;
    parameter Real k2_cNE = 22.0;
    parameter Real Vm_TS = 5000.0;
    parameter Real K_DUMP_TS = 6.3;
    parameter Real K_2cf_TS = 14.0;
    parameter Real Vm_MTHFR = 5300.0;
    parameter Real K_2cf_MTHFR = 50.0;
    parameter Real K_NADPH_MTHFR = 16.0;
    parameter Real Vf_cMTD = 80000.0;
    parameter Real Vr_cMTD = 600000.0;
    parameter Real Vf_cMTCH = 500000.0;
    parameter Real Vm_ART = 55000.0;
    parameter Real K_10f_ART = 5.9;
    parameter Real K_aic_ART = 100.0;
    parameter Real Vm_BHMT = 2160.0;
    parameter Real K_hcy_BHMT = 12.0;
    parameter Real K_bet_BHMT = 100.0;
    parameter Real Ki_BHMT = 0.01;
    parameter Real Vm_MAT1 = 260.0;
    parameter Real Km_MAT1 = 41.0;
    parameter Real Ki_MAT1 = 2140.0;
    parameter Real Vm_MAT3 = 220.0;
    parameter Real Km_MAT3 = 300.0;
    parameter Real Ka_MAT3 = 360.0;
    parameter Real Ki_MAT3 = 4030.0;
    parameter Real Vm_GNMT = 260.0;
    parameter Real K_sam_GNMT = 63.0;
    parameter Real K_gly_GNMT = 130.0;
    parameter Real Ki_GNMT = 18.0;
    parameter Real Vm_DNMT = 180.0;
    parameter Real Km_DNMT = 1.4;
    parameter Real Ki_DNMT = 1.4;
    parameter Real Vf_SAHH = 320.0;
    parameter Real K_sah_SAHH = 6.5;
    parameter Real Vr_SAHH = 4530.0;
    parameter Real K_hcy_SAHH = 150.0;
    parameter Real Vm_CBS = 420000.0;
    parameter Real K_hcy_CBS = 1000.0;
    parameter Real K_ser_CBS = 2000.0;
    parameter Real Ka_CBS = 0.035;
    parameter Real Vm_CTGL = 1500.0;
    parameter Real K_cyt_CTGL = 500.0;
    parameter Real Vm_GCS = 3600.0;
    parameter Real Ke_GCS = 5597.0;
    parameter Real K_cys_GCS = 100.0;
    parameter Real K_glu_GCS = 1900.0;
    parameter Real Ki_GCS = 8200.0;
    parameter Real Kp_GCS = 300.0;
    parameter Real Ka_GCS = 0.01;
    parameter Real Vm_GS = 5400.0;
    parameter Real Ke_GS = 5600.0;
    parameter Real K_gly_GS = 300.0;
    parameter Real K_glc_GS = 22.0;
    parameter Real Kp_GS = 30.0;
    parameter Real Vm_GPX = 4500.0;
    parameter Real K_gsh_GPX = 1330.0;
    parameter Real K_H2O2_GPX = 0.09;
    parameter Real Vm_GR = 892.5;
    parameter Real K_gsg_GR = 107.0;
    parameter Real K_NADPH_GR = 10.4;
    parameter Real dinner = 3.25;
    parameter Real lunch = 1.75;
    parameter Real breakfast = 1.75;
    parameter Real fasting = 0.25;
    parameter Real b_met_basal = 30.0;
    parameter Real b_ser_basal = 150.0;
    parameter Real V_oGly_b_basal = 630.0;
    parameter Real V_oGlu_b_basal = 273.0;
    parameter Real V_oCys_b_basal = 70.0;
    parameter Real k_out_cys = 1.0;
    parameter Real blood = 1.0;
    parameter Real cytosol = 1.0;
    parameter Real mito = 1.0;
    parameter Real cell = 1.0;

    Real tot_cfol(start=0.0);
    Real tot_mfol(start=0.0);
    Real V_oCys_b(start=0.0);
    Real V_oGly_b(start=0.0);
    Real V_oGlu_b(start=0.0);
    Real daytime(start=0.0);
    Real aa_input(start=0.0);

    Real b_met;
    Real b_ser;
    Real GAR;
    Real NADPH;
    Real BET;
    Real DUMP;
    Real Fol;
    Real H2O2;
    Real CO;
    Real HCHO;
    Real c_thf;
    Real m_thf;
    Real c_5mf;
    Real c_2cf;
    Real c_1cf;
    Real c_10f;
    Real c_dhf;
    Real m_2cf;
    Real m_1cf;
    Real m_10f;
    Real b_gly;
    Real b_glu;
    Real b_cys;
    Real b_gsg;
    Real b_gsh;
    Real aic;
    Real c_glu;
    Real c_cys;
    Real glc;
    Real c_gly;
    Real c_gsg;
    Real c_gsh;
    Real cyt;
    Real hcy;
    Real c_ser;
    Real sah;
    Real sam;
    Real met;
    Real c_coo;
    Real m_ser;
    Real m_gly;
    Real m_coo;
    Real src;
    Real dmg;

initial equation
    GAR = 10.0;
    NADPH = 50.0;
    BET = 50.0;
    DUMP = 20.0;
    Fol = 20.1;
    H2O2 = 0.01;
    CO = 0.0;
    HCHO = 500.0;
    c_thf = Fol / (2 * 3 / 4) - (c_5mf + c_2cf + c_1cf + c_10f + c_dhf);
    m_thf = Fol / (2 * 1 / 4) - (m_2cf + m_1cf + m_10f);
    c_5mf = 4.4965335653401;
    c_2cf = 0.506278119133034;
    c_1cf = 0.278602708139276;
    c_10f = 3.40907070478307;
    c_dhf = 0.0385952337473159;
    m_2cf = 1.66610924423152;
    m_1cf = 1.54929073348709;
    m_10f = 15.9087989350187;
    b_gly = 221.101111778807;
    b_glu = 60.4330872702655;
    b_cys = 185.50378543937;
    b_gsg = 0.484328542816829;
    b_gsh = 12.6996048211362;
    aic = 0.942750394171554;
    c_glu = 3219.39793573653;
    c_cys = 194.96740946034;
    glc = 9.80842470037426;
    c_gly = 924.429820216685;
    c_gsg = 61.3019611792609;
    c_gsh = 6590.56824161192;
    cyt = 36.8825861752429;
    hcy = 1.12248362561721;
    c_ser = 562.834377270222;
    sah = 19.1432773636787;
    sam = 81.1684566962769;
    met = 49.18682158;
    c_coo = 13.0888186429922;
    m_ser = 2114.87119909779;
    m_gly = 2040.43402532595;
    m_coo = 55.820116666595;
    src = 9.16245914628594;
    dmg = 0.707382712261505;

equation
    b_met = aa_input * b_met_basal;
    b_ser = aa_input * b_ser_basal;
    tot_cfol = c_5mf + c_2cf + c_1cf + c_10f + c_dhf + c_thf;
    tot_mfol = m_thf + m_2cf + m_1cf + m_10f;
    V_oCys_b = aa_input * V_oCys_b_basal;
    V_oGly_b = aa_input * V_oGly_b_basal;
    V_oGlu_b = aa_input * V_oGlu_b_basal;
    daytime = time - 24 * floor(time / 24);
    aa_input = piecewise(breakfast, and(leq(7, daytime), leq(daytime, 10)), lunch, and(leq(12, daytime), leq(daytime, 15)), dinner, and(leq(18, daytime), leq(daytime, 21)), fasting);
    der(GAR) = 0.0;
    der(NADPH) = 0.0;
    der(BET) = 0.0;
    der(DUMP) = 0.0;
    der(Fol) = 0.0;
    der(H2O2) = 0.0;
    der(CO) = 0.0;
    der(HCHO) = 0.0;
    der(c_thf) = (cytosol * MM_twosubst(Vm_MS, K_5mf_MS, K_hcy_MS, c_5mf, hcy) * (ssH2O2 + Ki_MS) / (H2O2 + Ki_MS)) + (cytosol * MM_twosubst(Vm_DHFR, K_dhf_DHFR, K_NADPH_DHFR, c_dhf, NADPH)) + (cytosol * MM(Vm_cFTD, K_10f_FTD, c_10f)) + (cytosol * MM_twosubst(Vm_PGT, K_10f_PGT, K_GAR_PGT, c_10f, GAR)) + (cytosol * MM_twosubst(Vm_ART, K_10f_ART, K_aic_ART, c_10f, aic)) - (cytosol * MM_twosubst(Vm_cFTS, K_thf_cFTS, K_coo_cFTS, c_thf, c_coo)) - (cytosol * (MM_twosubst(Vf_cSHMT, K_thf_SHMT, K_ser_SHMT, c_thf, c_ser) - MM_twosubst(Vr_cSHMT, K_gly_SHMT, K_2cf_SHMT, c_gly, c_2cf))) - (cytosol * (k1_cNE * c_thf * HCHO - k2_cNE * c_2cf));
    der(m_thf) = (mito * MM(Vm_mFTD, K_10f_FTD, m_10f)) - (mito * (MM_twosubst(Vf_mSHMT, K_thf_SHMT, K_ser_SHMT, m_thf, m_ser) - MM_twosubst(Vr_mSHMT, K_gly_SHMT, K_2cf_SHMT, m_gly, m_2cf))) - (mito * (MM_twosubst(Vf_mFTS, K_thf_mFTS, K_coo_mFTS, m_thf, m_coo) - MM(Vr_mFTS, K_10f_mFTS, m_10f))) - (mito * (k1_mNE * m_thf * HCHO - k2_mNE * m_2cf)) - (mito * MM_twosubst(Vm_GDC, K_thf_GDC, K_gly_GDC, m_thf, m_gly)) - (mito * MM_twosubst(Vm_SDH, K_thf_SDH, K_src_SDH, m_thf, src)) - (mito * MM_twosubst(Vm_DMGD, K_thf_DMGD, K_dmg_DMGD, m_thf, dmg));
    der(c_5mf) = (cytosol * MM_twosubst(Vm_MTHFR, K_2cf_MTHFR, K_NADPH_MTHFR, c_2cf, NADPH) * 72 / (10 + sam - sah)) - (cytosol * MM_twosubst(Vm_MS, K_5mf_MS, K_hcy_MS, c_5mf, hcy) * (ssH2O2 + Ki_MS) / (H2O2 + Ki_MS));
    der(c_2cf) = (cytosol * (MM_twosubst(Vf_cSHMT, K_thf_SHMT, K_ser_SHMT, c_thf, c_ser) - MM_twosubst(Vr_cSHMT, K_gly_SHMT, K_2cf_SHMT, c_gly, c_2cf))) + (cytosol * (k1_cNE * c_thf * HCHO - k2_cNE * c_2cf)) - (cytosol * MM_twosubst(Vm_TS, K_DUMP_TS, K_2cf_TS, DUMP, c_2cf)) - (cytosol * MM_twosubst(Vm_MTHFR, K_2cf_MTHFR, K_NADPH_MTHFR, c_2cf, NADPH) * 72 / (10 + sam - sah)) - (cytosol * (MM(Vf_cMTD, K_2cf_MTD, c_2cf) - MM(Vr_cMTD, K_1cf_MTD, c_1cf)));
    der(c_1cf) = (cytosol * (MM(Vf_cMTD, K_2cf_MTD, c_2cf) - MM(Vr_cMTD, K_1cf_MTD, c_1cf))) - (cytosol * (MM(Vf_cMTCH, K_1cf_MTCH, c_1cf) - MM(Vr_MTCH, K_10f_MTCH, c_10f)));
    der(c_10f) = (cytosol * MM_twosubst(Vm_cFTS, K_thf_cFTS, K_coo_cFTS, c_thf, c_coo)) + (cytosol * (MM(Vf_cMTCH, K_1cf_MTCH, c_1cf) - MM(Vr_MTCH, K_10f_MTCH, c_10f))) - (cytosol * MM(Vm_cFTD, K_10f_FTD, c_10f)) - (cytosol * MM_twosubst(Vm_PGT, K_10f_PGT, K_GAR_PGT, c_10f, GAR)) - (cytosol * MM_twosubst(Vm_ART, K_10f_ART, K_aic_ART, c_10f, aic));
    der(c_dhf) = (cytosol * MM_twosubst(Vm_TS, K_DUMP_TS, K_2cf_TS, DUMP, c_2cf)) - (cytosol * MM_twosubst(Vm_DHFR, K_dhf_DHFR, K_NADPH_DHFR, c_dhf, NADPH));
    der(m_2cf) = (mito * (MM_twosubst(Vf_mSHMT, K_thf_SHMT, K_ser_SHMT, m_thf, m_ser) - MM_twosubst(Vr_mSHMT, K_gly_SHMT, K_2cf_SHMT, m_gly, m_2cf))) + (mito * (k1_mNE * m_thf * HCHO - k2_mNE * m_2cf)) + (mito * MM_twosubst(Vm_GDC, K_thf_GDC, K_gly_GDC, m_thf, m_gly)) + (mito * MM_twosubst(Vm_SDH, K_thf_SDH, K_src_SDH, m_thf, src)) + (mito * MM_twosubst(Vm_DMGD, K_thf_DMGD, K_dmg_DMGD, m_thf, dmg)) - (mito * (MM(Vf_mMTD, K_2cf_MTD, m_2cf) - MM(Vr_MTD, K_1cf_MTD, m_1cf)));
    der(m_1cf) = (mito * (MM(Vf_mMTD, K_2cf_MTD, m_2cf) - MM(Vr_MTD, K_1cf_MTD, m_1cf))) - (mito * (MM(Vf_mMTCH, K_1cf_MTCH, m_1cf) - MM(Vr_MTCH, K_10f_MTCH, m_10f)));
    der(m_10f) = (mito * (MM_twosubst(Vf_mFTS, K_thf_mFTS, K_coo_mFTS, m_thf, m_coo) - MM(Vr_mFTS, K_10f_mFTS, m_10f))) + (mito * (MM(Vf_mMTCH, K_1cf_MTCH, m_1cf) - MM(Vr_MTCH, K_10f_MTCH, m_10f))) - (mito * MM(Vm_mFTD, K_10f_FTD, m_10f));
    der(b_gly) = (blood * 90 * b_gsh) + (2.0 * blood * 67.5 * b_gsg) + (blood * V_oGly_b) - (blood * 0.1 * b_gly) - (cytosol * (MM(V_bglyc, K_bglyc, b_gly) - k_out_gly * c_gly));
    der(b_glu) = (blood * 90 * b_gsh) + (2.0 * blood * 67.5 * b_gsg) + (blood * V_oGlu_b) - (blood * 0.1 * b_glu) - (cytosol * (MM(V_bglutc, K_bglutc, b_glu) - k_out_glu * c_glu));
    der(b_cys) = (blood * 90 * b_gsh) + (2.0 * blood * 67.5 * b_gsg) + (blood * V_oCys_b) - (blood * 0.25 * b_cys) - (blood * 0.1 * b_cys) - (cytosol * MM(V_bcysc, K_bcysc, b_cys));
    der(b_gsg) = (cytosol * MM(V_gsgHb, K_gsgHb, c_gsg)) + (cytosol * MM(V_gsgLb, K_gsgLb, c_gsg)) - (blood * 67.5 * b_gsg) - (blood * 7.5 * b_gsg);
    der(b_gsh) = (cytosol * MM(V_gshHb, K_gshHb, c_gsh)) + (cytosol * V_gshLb * c_gsh^h_gshLb / (K_gshLb^h_gshLb + c_gsh^h_gshLb)) - (blood * 90 * b_gsh) - (blood * 0.7 * b_gsh);
    der(aic) = (cytosol * MM_twosubst(Vm_PGT, K_10f_PGT, K_GAR_PGT, c_10f, GAR)) - (cytosol * MM_twosubst(Vm_ART, K_10f_ART, K_aic_ART, c_10f, aic));
    der(c_glu) = (cytosol * (MM(V_bglutc, K_bglutc, b_glu) - k_out_glu * c_glu)) - ((cytosol * Vm_GCS * (c_cys * c_glu - glc / Ke_GCS) / (K_cys_GCS * K_glu_GCS + c_glu * K_cys_GCS + c_cys * (K_glu_GCS * (1 + c_gsh / Ki_GCS) + c_glu) + glc / Kp_GCS + c_gsh / Ki_GCS)) * ((H2O2 + Ka_GCS) / (ssH2O2 + Ka_GCS))) - (cytosol * 0.07 * c_glu);
    der(c_cys) = (cytosol * MM(V_bcysc, K_bcysc, b_cys)) + (cytosol * MM(Vm_CTGL, K_cyt_CTGL, cyt)) - ((cytosol * Vm_GCS * (c_cys * c_glu - glc / Ke_GCS) / (K_cys_GCS * K_glu_GCS + c_glu * K_cys_GCS + c_cys * (K_glu_GCS * (1 + c_gsh / Ki_GCS) + c_glu) + glc / Kp_GCS + c_gsh / Ki_GCS)) * ((H2O2 + Ka_GCS) / (ssH2O2 + Ka_GCS))) - (cytosol * 0.35 * c_cys^2 / 200);
    der(glc) = ((cytosol * Vm_GCS * (c_cys * c_glu - glc / Ke_GCS) / (K_cys_GCS * K_glu_GCS + c_glu * K_cys_GCS + c_cys * (K_glu_GCS * (1 + c_gsh / Ki_GCS) + c_glu) + glc / Kp_GCS + c_gsh / Ki_GCS)) * ((H2O2 + Ka_GCS) / (ssH2O2 + Ka_GCS))) - (cytosol * Vm_GS * (c_gly * glc - c_gsh / Ke_GS) / (K_gly_GS * K_glc_GS + glc * K_gly_GS + c_gly * (K_glc_GS + glc) + c_gsh / Kp_GS));
    der(c_gly) = (cytosol * (MM(V_bglyc, K_bglyc, b_gly) - k_out_gly * c_gly)) + (MM(V_mgly, K_mgly, m_gly) * mito * (1 / 3) - MM(V_cgly, K_cgly, c_gly) * cytosol) + (cytosol * (MM_twosubst(Vf_cSHMT, K_thf_SHMT, K_ser_SHMT, c_thf, c_ser) - MM_twosubst(Vr_cSHMT, K_gly_SHMT, K_2cf_SHMT, c_gly, c_2cf))) - (cytosol * MM_twosubst(Vm_GNMT, K_sam_GNMT, K_gly_GNMT, sam, c_gly) * (1 / (1 + sah / Ki_GNMT)) * (4.8 / (0.35 + c_5mf))) - (cytosol * Vm_GS * (c_gly * glc - c_gsh / Ke_GS) / (K_gly_GS * K_glc_GS + glc * K_gly_GS + c_gly * (K_glc_GS + glc) + c_gsh / Kp_GS));
    der(c_gsg) = (cytosol * Vm_GPX * (c_gsh / (K_gsh_GPX + c_gsh))^2 * (H2O2 / (K_H2O2_GPX + H2O2))) - (cytosol * MM(V_gsgHb, K_gsgHb, c_gsg)) - (cytosol * MM(V_gsgLb, K_gsgLb, c_gsg)) - (cytosol * MM_twosubst(Vm_GR, K_gsg_GR, K_NADPH_GR, c_gsg, NADPH)) - (cytosol * 0.1 * c_gsg);
    der(c_gsh) = (cytosol * Vm_GS * (c_gly * glc - c_gsh / Ke_GS) / (K_gly_GS * K_glc_GS + glc * K_gly_GS + c_gly * (K_glc_GS + glc) + c_gsh / Kp_GS)) + (2.0 * cytosol * MM_twosubst(Vm_GR, K_gsg_GR, K_NADPH_GR, c_gsg, NADPH)) - (cytosol * MM(V_gshHb, K_gshHb, c_gsh)) - (cytosol * V_gshLb * c_gsh^h_gshLb / (K_gshLb^h_gshLb + c_gsh^h_gshLb)) - (2.0 * cytosol * Vm_GPX * (c_gsh / (K_gsh_GPX + c_gsh))^2 * (H2O2 / (K_H2O2_GPX + H2O2))) - (cytosol * 0.002 * c_gsh);
    der(cyt) = (cytosol * MM_twosubst(Vm_CBS, K_hcy_CBS, K_ser_CBS, hcy, c_ser) * (((30 / 102.59)^2 + 1) / ((30 / (sam + sah))^2 + 1)) * ((H2O2 + Ka_CBS) / (ssH2O2 + Ka_CBS))) - (cytosol * MM(Vm_CTGL, K_cyt_CTGL, cyt));
    der(hcy) = (cytosol * (MM(Vf_SAHH, K_sah_SAHH, sah) - MM(Vr_SAHH, K_hcy_SAHH, hcy))) - (cytosol * MM_twosubst(Vm_MS, K_5mf_MS, K_hcy_MS, c_5mf, hcy) * (ssH2O2 + Ki_MS) / (H2O2 + Ki_MS)) - (cytosol * exp(-0.0021 * (sam + sah)) * exp(0.0021 * 102.6) * MM_twosubst(Vm_BHMT, K_hcy_BHMT, K_bet_BHMT, hcy, BET) * ((ssH2O2 + Ki_BHMT) / (H2O2 + Ki_BHMT))) - (cytosol * MM_twosubst(Vm_CBS, K_hcy_CBS, K_ser_CBS, hcy, c_ser) * (((30 / 102.59)^2 + 1) / ((30 / (sam + sah))^2 + 1)) * ((H2O2 + Ka_CBS) / (ssH2O2 + Ka_CBS)));
    der(c_ser) = (cytosol * (MM(V_bserc, K_bserc, b_ser) - k_out_ser * c_ser)) + ((MM(V_mser, K_mser, m_ser) * mito / 3 - MM(V_cser, K_cser, c_ser)) * cytosol) - (cytosol * (MM_twosubst(Vf_cSHMT, K_thf_SHMT, K_ser_SHMT, c_thf, c_ser) - MM_twosubst(Vr_cSHMT, K_gly_SHMT, K_2cf_SHMT, c_gly, c_2cf))) - (cytosol * 1.2 * c_ser) - (cytosol * MM_twosubst(Vm_CBS, K_hcy_CBS, K_ser_CBS, hcy, c_ser) * (((30 / 102.59)^2 + 1) / ((30 / (sam + sah))^2 + 1)) * ((H2O2 + Ka_CBS) / (ssH2O2 + Ka_CBS)));
    der(sah) = (cytosol * MM_twosubst(Vm_GNMT, K_sam_GNMT, K_gly_GNMT, sam, c_gly) * (1 / (1 + sah / Ki_GNMT)) * (4.8 / (0.35 + c_5mf))) + (cytosol * Vm_DNMT * (sam / (Km_DNMT * (1 + sah / Ki_DNMT) + sam))) - (cytosol * (MM(Vf_SAHH, K_sah_SAHH, sah) - MM(Vr_SAHH, K_hcy_SAHH, hcy)));
    der(sam) = (cytosol * Vm_MAT1 * (met / (Km_MAT1 + met)) * (0.23 + 0.8 * exp(-0.0026 * sam)) * ((Ki_MAT1 + 66.71) / (Ki_MAT1 + c_gsg))) + (cytosol * Vm_MAT3 * (met^1.21 / (Km_MAT3 + met^1.21)) * (1 + 7.2 * sam^2 / (Ka_MAT3^2 + sam^2)) * ((Ki_MAT3 + 66.71) / (Ki_MAT3 + c_gsg))) - (cytosol * MM_twosubst(Vm_GNMT, K_sam_GNMT, K_gly_GNMT, sam, c_gly) * (1 / (1 + sah / Ki_GNMT)) * (4.8 / (0.35 + c_5mf))) - (cytosol * Vm_DNMT * (sam / (Km_DNMT * (1 + sah / Ki_DNMT) + sam)));
    der(met) = (cytosol * (MM(V_bmetc, K_bmetc, b_met) - k_out_met * met)) + (cytosol * MM_twosubst(Vm_MS, K_5mf_MS, K_hcy_MS, c_5mf, hcy) * (ssH2O2 + Ki_MS) / (H2O2 + Ki_MS)) + (cytosol * exp(-0.0021 * (sam + sah)) * exp(0.0021 * 102.6) * MM_twosubst(Vm_BHMT, K_hcy_BHMT, K_bet_BHMT, hcy, BET) * ((ssH2O2 + Ki_BHMT) / (H2O2 + Ki_BHMT))) - (cytosol * Vm_MAT1 * (met / (Km_MAT1 + met)) * (0.23 + 0.8 * exp(-0.0026 * sam)) * ((Ki_MAT1 + 66.71) / (Ki_MAT1 + c_gsg))) - (cytosol * Vm_MAT3 * (met^1.21 / (Km_MAT3 + met^1.21)) * (1 + 7.2 * sam^2 / (Ka_MAT3^2 + sam^2)) * ((Ki_MAT3 + 66.71) / (Ki_MAT3 + c_gsg)));
    der(c_coo) = (k_in_coo * m_coo * mito / 3 - k_out_coo * c_coo * cytosol) - (cytosol * MM_twosubst(Vm_cFTS, K_thf_cFTS, K_coo_cFTS, c_thf, c_coo));
    der(m_ser) =  - (mito * (MM_twosubst(Vf_mSHMT, K_thf_SHMT, K_ser_SHMT, m_thf, m_ser) - MM_twosubst(Vr_mSHMT, K_gly_SHMT, K_2cf_SHMT, m_gly, m_2cf))) - (3.0 * (MM(V_mser, K_mser, m_ser) * mito / 3 - MM(V_cser, K_cser, c_ser)) * cytosol);
    der(m_gly) = (mito * (MM_twosubst(Vf_mSHMT, K_thf_SHMT, K_ser_SHMT, m_thf, m_ser) - MM_twosubst(Vr_mSHMT, K_gly_SHMT, K_2cf_SHMT, m_gly, m_2cf))) + (mito * MM_twosubst(Vm_SDH, K_thf_SDH, K_src_SDH, m_thf, src)) - (mito * MM_twosubst(Vm_GDC, K_thf_GDC, K_gly_GDC, m_thf, m_gly)) - (3.0 * MM(V_mgly, K_mgly, m_gly) * mito * (1 / 3) - MM(V_cgly, K_cgly, c_gly) * cytosol);
    der(m_coo) =  - (mito * (MM_twosubst(Vf_mFTS, K_thf_mFTS, K_coo_mFTS, m_thf, m_coo) - MM(Vr_mFTS, K_10f_mFTS, m_10f))) - (3.0 * k_in_coo * m_coo * mito / 3 - k_out_coo * c_coo * cytosol);
    der(src) = (mito * MM_twosubst(Vm_DMGD, K_thf_DMGD, K_dmg_DMGD, m_thf, dmg)) + (cytosol * MM_twosubst(Vm_GNMT, K_sam_GNMT, K_gly_GNMT, sam, c_gly) * (1 / (1 + sah / Ki_GNMT)) * (4.8 / (0.35 + c_5mf))) - (mito * MM_twosubst(Vm_SDH, K_thf_SDH, K_src_SDH, m_thf, src));
    der(dmg) = (cytosol * exp(-0.0021 * (sam + sah)) * exp(0.0021 * 102.6) * MM_twosubst(Vm_BHMT, K_hcy_BHMT, K_bet_BHMT, hcy, BET) * ((ssH2O2 + Ki_BHMT) / (H2O2 + Ki_BHMT))) - (mito * MM_twosubst(Vm_DMGD, K_thf_DMGD, K_dmg_DMGD, m_thf, dmg));




end BIOMD268;
