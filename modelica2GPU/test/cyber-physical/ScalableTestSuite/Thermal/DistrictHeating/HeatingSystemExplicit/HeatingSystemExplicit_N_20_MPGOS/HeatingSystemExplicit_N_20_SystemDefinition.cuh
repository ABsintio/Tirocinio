
#ifndef HEATINGSYSTEMEXPLICIT_N_20_PERTHREAD_SYSTEMDEFINITION_H
#define HEATINGSYSTEMEXPLICIT_N_20_PERTHREAD_SYSTEMDEFINITION_H

#include <fstream>
#include <iostream>
#include <string>
#include "Functions.cuh"


template<class Precision> __forceinline__ __device__ void PerThread_OdeFunction(
	int tid, int NT, \
	Precision*    F, Precision*    X, Precision     T, \
	Precision* cPAR, Precision* sPAR, int*      sPARi, Precision* ACC, int* ACCi  		
) {
    F[40]=(50.0 * hist(X[40],(293.15 - X[20]),0.5));
    F[20]=((8.517887563884156e-06 * ((X[0] - X[20]) * (0.5 + sat((15.0 * X[40]),-0.5,0.5)))) + (-6.388415672913117e-06 * (-278.15 + (X[20] + (-8.0 * sin((7.27220521664304e-05 * T)))))));
    F[39]=(50.0 * hist(X[39],(293.15 - X[19]),0.5));
    F[19]=((8.783284023668639e-06 * ((X[0] - X[19]) * (0.5 + sat((15.0 * X[39]),-0.5,0.5)))) + (-6.587463017751478e-06 * (-278.15 + (X[19] + (-8.0 * sin((7.27220521664304e-05 * T)))))));
    F[38]=(50.0 * hist(X[38],(293.15 - X[18]),0.5));
    F[18]=((9.065750548716482e-06 * ((X[0] - X[18]) * (0.5 + sat((15.0 * X[38]),-0.5,0.5)))) + (-6.799312911537361e-06 * (-278.15 + (X[18] + (-8.0 * sin((7.27220521664304e-05 * T)))))));
    F[37]=(50.0 * hist(X[37],(293.15 - X[17]),0.5));
    F[17]=((9.366988759613486e-06 * ((X[0] - X[17]) * (0.5 + sat((15.0 * X[37]),-0.5,0.5)))) + (-7.025241569710116e-06 * (-278.15 + (X[17] + (-8.0 * sin((7.27220521664304e-05 * T)))))));
    F[36]=(50.0 * hist(X[36],(293.15 - X[16]),0.5));
    F[16]=((9.688934217236105e-06 * ((X[0] - X[16]) * (0.5 + sat((15.0 * X[36]),-0.5,0.5)))) + (-7.266700662927079e-06 * (-278.15 + (X[16] + (-8.0 * sin((7.27220521664304e-05 * T)))))));
    F[35]=(50.0 * hist(X[35],(293.15 - X[15]),0.5));
    F[15]=((1.003379805661175e-05 * ((X[0] - X[15]) * (0.5 + sat((15.0 * X[35]),-0.5,0.5)))) + (-7.525348542458808e-06 * (-278.15 + (X[15] + (-8.0 * sin((7.27220521664304e-05 * T)))))));
    F[34]=(50.0 * hist(X[34],(293.15 - X[14]),0.5));
    F[14]=((1.040411784032417e-05 * ((X[0] - X[14]) * (0.5 + sat((15.0 * X[34]),-0.5,0.5)))) + (-7.803088380243126e-06 * (-278.15 + (X[14] + (-8.0 * sin((7.27220521664304e-05 * T)))))));
    F[33]=(50.0 * hist(X[33],(293.15 - X[13]),0.5));
    F[13]=((1.080282010461678e-05 * ((X[0] - X[13]) * (0.5 + sat((15.0 * X[33]),-0.5,0.5)))) + (-8.102115078462587e-06 * (-278.15 + (X[13] + (-8.0 * sin((7.27220521664304e-05 * T)))))));
    F[32]=(50.0 * hist(X[32],(293.15 - X[12]),0.5));
    F[12]=((1.123329785976115e-05 * ((X[0] - X[12]) * (0.5 + sat((15.0 * X[32]),-0.5,0.5)))) + (-8.424973394820858e-06 * (-278.15 + (X[12] + (-8.0 * sin((7.27220521664304e-05 * T)))))));
    F[31]=(50.0 * hist(X[31],(293.15 - X[11]),0.5));
    F[11]=((1.169950738916256e-05 * ((X[0] - X[11]) * (0.5 + sat((15.0 * X[31]),-0.5,0.5)))) + (-8.774630541871919e-06 * (-278.15 + (X[11] + (-8.0 * sin((7.27220521664304e-05 * T)))))));
    F[30]=(50.0 * hist(X[30],(293.15 - X[10]),0.5));
    F[10]=((1.220609019658229e-05 * ((X[0] - X[10]) * (0.5 + sat((15.0 * X[30]),-0.5,0.5)))) + (-9.15456764743672e-06 * (-278.15 + (X[10] + (-8.0 * sin((7.27220521664304e-05 * T)))))));
    F[29]=(50.0 * hist(X[29],(293.15 - X[9]),0.5));
    F[9]=((1.275852806876175e-05 * ((X[0] - X[9]) * (0.5 + sat((15.0 * X[29]),-0.5,0.5)))) + (-9.568896051571313e-06 * (-278.15 + (X[9] + (-8.0 * sin((7.27220521664304e-05 * T)))))));
    F[28]=(50.0 * hist(X[28],(293.15 - X[8]),0.5));
    F[8]=((1.336334224222816e-05 * ((X[0] - X[8]) * (0.5 + sat((15.0 * X[28]),-0.5,0.5)))) + (-1.002250668167112e-05 * (-278.15 + (X[8] + (-8.0 * sin((7.27220521664304e-05 * T)))))));
    F[27]=(50.0 * hist(X[27],(293.15 - X[7]),0.5));
    F[7]=((1.402835203780272e-05 * ((X[0] - X[7]) * (0.5 + sat((15.0 * X[27]),-0.5,0.5)))) + (-1.052126402835204e-05 * (-278.15 + (X[7] + (-8.0 * sin((7.27220521664304e-05 * T)))))));
    F[26]=(50.0 * hist(X[26],(293.15 - X[6]),0.5));
    F[6]=((1.476301476301476e-05 * ((X[0] - X[6]) * (0.5 + sat((15.0 * X[26]),-0.5,0.5)))) + (-1.107226107226107e-05 * (-278.15 + (X[6] + (-8.0 * sin((7.27220521664304e-05 * T)))))));
    F[25]=(50.0 * hist(X[25],(293.15 - X[5]),0.5));
    F[5]=((1.557887832076091e-05 * ((X[0] - X[5]) * (0.5 + sat((15.0 * X[25]),-0.5,0.5)))) + (-1.168415874057068e-05 * (-278.15 + (X[5] + (-8.0 * sin((7.27220521664304e-05 * T)))))));
    F[24]=(50.0 * hist(X[24],(293.15 - X[4]),0.5));
    F[4]=((1.649019267488283e-05 * ((X[0] - X[4]) * (0.5 + sat((15.0 * X[24]),-0.5,0.5)))) + (-1.236764450616212e-05 * (-278.15 + (X[4] + (-8.0 * sin((7.27220521664304e-05 * T)))))));
    F[23]=(50.0 * hist(X[23],(293.15 - X[3]),0.5));
    F[3]=((1.751474926253687e-05 * ((X[0] - X[3]) * (0.5 + sat((15.0 * X[23]),-0.5,0.5)))) + (-1.313606194690265e-05 * (-278.15 + (X[3] + (-8.0 * sin((7.27220521664304e-05 * T)))))));
    F[22]=(50.0 * hist(X[22],(293.15 - X[2]),0.5));
    F[2]=((1.867505405936702e-05 * ((X[0] - X[2]) * (0.5 + sat((15.0 * X[22]),-0.5,0.5)))) + (-1.400629054452526e-05 * (-278.15 + (X[2] + (-8.0 * sin((7.27220521664304e-05 * T)))))));
    F[21]=(50.0 * hist(X[21],(293.15 - X[1]),0.5));
    F[1]=((2e-05 * ((X[0] - X[1]) * (0.5 + sat((15.0 * X[21]),-0.5,0.5)))) + (-1.5e-05 * (-278.15 + (X[1] + (-8.0 * sin((7.27220521664304e-05 * T)))))));
    F[0]=((2.5e-08 * sat((15000.0 * (343.15 - X[0])),0.0,60000.0)) + (-5e-06 * (((X[0] - X[1]) * (0.5 + sat((15.0 * X[21]),-0.5,0.5))) + (((X[0] - X[2]) * (0.5 + sat((15.0 * X[22]),-0.5,0.5))) + (((X[0] - X[3]) * (0.5 + sat((15.0 * X[23]),-0.5,0.5))) + (((X[0] - X[4]) * (0.5 + sat((15.0 * X[24]),-0.5,0.5))) + (((X[0] - X[5]) * (0.5 + sat((15.0 * X[25]),-0.5,0.5))) + (((X[0] - X[6]) * (0.5 + sat((15.0 * X[26]),-0.5,0.5))) + (((X[0] - X[7]) * (0.5 + sat((15.0 * X[27]),-0.5,0.5))) + (((X[0] - X[8]) * (0.5 + sat((15.0 * X[28]),-0.5,0.5))) + (((X[0] - X[9]) * (0.5 + sat((15.0 * X[29]),-0.5,0.5))) + (((X[0] - X[10]) * (0.5 + sat((15.0 * X[30]),-0.5,0.5))) + (((X[0] - X[11]) * (0.5 + sat((15.0 * X[31]),-0.5,0.5))) + (((X[0] - X[12]) * (0.5 + sat((15.0 * X[32]),-0.5,0.5))) + (((X[0] - X[13]) * (0.5 + sat((15.0 * X[33]),-0.5,0.5))) + (((X[0] - X[14]) * (0.5 + sat((15.0 * X[34]),-0.5,0.5))) + (((X[0] - X[15]) * (0.5 + sat((15.0 * X[35]),-0.5,0.5))) + (((X[0] - X[16]) * (0.5 + sat((15.0 * X[36]),-0.5,0.5))) + (((X[0] - X[17]) * (0.5 + sat((15.0 * X[37]),-0.5,0.5))) + (((X[0] - X[18]) * (0.5 + sat((15.0 * X[38]),-0.5,0.5))) + (((X[0] - X[19]) * (0.5 + sat((15.0 * X[39]),-0.5,0.5))) + ((X[0] - X[20]) * (0.5 + sat((15.0 * X[40]),-0.5,0.5))))))))))))))))))))))));

}

template<class Precision> __forceinline__ __device__ void PerThread_EventFunction(
	int tid, int NT, Precision*	  EF, \
	Precision     T, Precision    dT, Precision*    TD, Precision*	X, \
	Precision* cPAR, Precision* sPAR, int*       sPARi, Precision* ACC, int* ACCi  		
) {
    

}

template<class Precision> __forceinline__ __device__ void PerThread_ActionAfterEventDetection(
    int tid, int NT, int IDX, int& UDT, \
    Precision    &T, Precision   &dT, Precision*    TD, Precision*   X, \
    Precision* cPAR, Precision* sPAR, int*       sPARi, Precision* ACC, int* ACCi
) {
    
}

template<class Precision> __forceinline__ __device__ void PerThread_ActionAfterSuccessfulTimeStep(
    int tid, int NT, int& UDT, \
    Precision&    T, Precision&   dT, Precision*    TD, Precision*   X, \
    Precision* cPAR, Precision* sPAR, int*       sPARi, Precision* ACC, int* ACCi
) {
    
}

template<class Precision> __forceinline__ __device__ void PerThread_Initialization(
    int tid, int NT, int& DOIDX, \
    Precision&    T, Precision&   dT, Precision*    TD, Precision*   X, \
    Precision* cPAR, Precision* sPAR,       int* sPARi, Precision* ACC, int* ACCi
) {
    T     = TD[0];
    DOIDX = 0;
    sPARi[0]=20; //N
    X[0]=343.15; //Td
    X[1]=293.15; //Tu[1]
    X[2]=293.15; //Tu[2]
    X[3]=293.15; //Tu[3]
    X[4]=293.15; //Tu[4]
    X[5]=293.15; //Tu[5]
    X[6]=293.15; //Tu[6]
    X[7]=293.15; //Tu[7]
    X[8]=293.15; //Tu[8]
    X[9]=293.15; //Tu[9]
    X[10]=293.15; //Tu[10]
    X[11]=293.15; //Tu[11]
    X[12]=293.15; //Tu[12]
    X[13]=293.15; //Tu[13]
    X[14]=293.15; //Tu[14]
    X[15]=293.15; //Tu[15]
    X[16]=293.15; //Tu[16]
    X[17]=293.15; //Tu[17]
    X[18]=293.15; //Tu[18]
    X[19]=293.15; //Tu[19]
    X[20]=293.15; //Tu[20]
    X[21]=-0.5; //x[1]
    X[22]=-0.5; //x[2]
    X[23]=-0.5; //x[3]
    X[24]=-0.5; //x[4]
    X[25]=-0.5; //x[5]
    X[26]=-0.5; //x[6]
    X[27]=-0.5; //x[7]
    X[28]=-0.5; //x[8]
    X[29]=-0.5; //x[9]
    X[30]=-0.5; //x[10]
    X[31]=-0.5; //x[11]
    X[32]=-0.5; //x[12]
    X[33]=-0.5; //x[13]
    X[34]=-0.5; //x[14]
    X[35]=-0.5; //x[15]
    X[36]=-0.5; //x[16]
    X[37]=-0.5; //x[17]
    X[38]=-0.5; //x[18]
    X[39]=-0.5; //x[19]
    X[40]=-0.5; //x[20]

}

template <class Precision> __forceinline__ __device__ void PerThread_Finalization(
    int tid, int NT, int& DOIDX, \
    Precision&    T, Precision&   dT, Precision*    TD, Precision*   X, \
    Precision* cPAR, Precision* sPAR,       int* sPARi, Precision* ACC, int* ACCi
) {
	
}


#endif
